if (self.CavalryLogger) { CavalryLogger.start_js(["4D0Tq"]); }

__d("Shaka",["Promise"],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();var h=c('Promise'),i={};(function(j){var k,l=this;function m(im,jm){var km=im.split("."),lm=l;km[0] in lm||!lm.execScript||lm.execScript("var "+km[0]);for(var mm;km.length&&(mm=km.shift());)km.length||void 0===jm?lm[mm]?lm=lm[mm]:lm=lm[mm]={}:lm[mm]=jm;}function n(im,jm){function km(){}km.prototype=jm.prototype;im.dc=jm.prototype;im.prototype=new km();im.prototype.constructor=im;im.cc=function(lm,mm,nm){return jm.prototype[mm].apply(lm,Array.prototype.slice.call(arguments,2));};}function o(){}function p(im){var jm=console[im];jm?jm.bind||(console[im]=function(){jm.apply(console,arguments);}):console[im]=function(){};}p("error");p("warn");p("info");p("log");p("debug");function q(im){u[im]={ha:t(),end:NaN};}function r(im){if(im=u[im])im.end=t();}function s(im){return (im=u[im])&&im.end?im.end-im.ha:NaN;}var t=j.performance&&j.performance.now?j.performance.now.bind(j.performance):Date.now,u={};function v(im,jm,km,lm){this.id=im;this.bandwidth=jm||0;this.lang=km||"unknown";this.streamInfoID=lm;this.active=false;}m("shaka.player.AudioTrack.compare",function(im,jm){return im.lang<jm.lang?-1:im.lang>jm.lang?1:im.bandwidth<jm.bandwidth?-1:im.bandwidth>jm.bandwidth?1:0;});function w(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.minHeight=this.maxHeight=null;}w.prototype.clone=function(){var im=new w();im.maxHeight=this.maxHeight;im.minHeight=this.minHeight;im.maxWidth=this.maxWidth;im.maxBandwidth=this.maxBandwidth;im.minBandwidth=this.minBandwidth;return im;};function x(){this.fontSize="100%";this.fontColor=aa;this.fontOpacity=ca;this.backgroundColor=ba;this.backgroundOpacity=ca;this.fontEdge=da;}m("shaka.player.TextStyle",x);function y(im){var jm=[];jm.push("font-size: "+im.fontSize);jm.push("color: "+z(im.fontColor,im.fontOpacity));jm.push("background-color: "+z(im.backgroundColor,im.backgroundOpacity));for(var km=[],lm=0;lm<im.fontEdge.length;++lm){var mm=im.fontEdge[lm].slice(3,6);km.push(z(im.fontEdge[lm].slice(0,3),im.fontOpacity)+" "+mm.join("px ")+"px");}jm.push("text-shadow: "+km.join(","));return jm.join("; ");}function z(im,jm){return "rgba("+im.concat(jm).join(",")+")";}var aa=[255,255,255],ba=[0,0,0];x.StandardColors={WHITE:aa,BLACK:ba,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var ca=1;x.StandardOpacities={OPAQUE:ca,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var da=[];x.EdgeStyles={NONE:da,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function ea(im,jm){this.id=im;this.lang=jm||"unknown";this.enabled=this.active=false;}m("shaka.player.TextTrack.compare",function(im,jm){return im.lang<jm.lang?-1:im.lang>jm.lang?1:0;});function fa(im,jm,km,lm,mm,nm,om){this.id=im;this.bandwidth=jm||0;this.width=km||0;this.height=lm||0;this.streamInfoID=mm;this.fbQualityLabel=nm;this.fbQualityClass=om;this.active=false;}function ga(im,jm){var km=im.width*im.height,lm=jm.width*jm.height;return km<lm?-1:km>lm?1:im.bandwidth<jm.bandwidth?-1:im.bandwidth>jm.bandwidth?1:0;}m("shaka.player.VideoTrack.compare",ga);function ha(){var im="CustomEvent" in j;if(im)try{new CustomEvent("");}catch(jm){im=false;}im||(j.CustomEvent=ia);}m("shaka.polyfill.CustomEvent.install",ha);function ia(im,jm){var km=document.createEvent("CustomEvent"),lm=jm||{bubbles:false,cancelable:false,detail:null};km.initCustomEvent(im,!!lm.bubbles,!!lm.cancelable,lm.detail);return km;}function ja(){var im=Element.prototype;im.requestFullscreen=im.requestFullscreen||im.mozRequestFullScreen||im.msRequestFullscreen||im.webkitRequestFullscreen;im=Document.prototype;im.exitFullscreen=im.exitFullscreen||im.mozCancelFullScreen||im.msExitFullscreen||im.webkitExitFullscreen;"fullscreenElement" in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement;}});document.addEventListener("webkitfullscreenchange",ka);document.addEventListener("webkitfullscreenerror",ka);document.addEventListener("mozfullscreenchange",ka);document.addEventListener("mozfullscreenerror",ka);document.addEventListener("MSFullscreenChange",ka);document.addEventListener("MSFullscreenError",ka);}m("shaka.polyfill.Fullscreen.install",ja);function ka(im){var jm=im.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),jm=new Event(jm,im);im.target.dispatchEvent(jm);}function la(){return h.reject(Error("The key system specified is not supported."));}function ma(im){return null==im?h.resolve():h.reject(Error("MediaKeys not supported."));}function na(){throw new TypeError("Illegal constructor.");}na.prototype.createSession=function(){};na.prototype.setServerCertificate=function(){};function oa(){throw new TypeError("Illegal constructor.");}oa.prototype.getConfiguration=function(){};oa.prototype.createMediaKeys=function(){};function pa(im){this.c=[];this.b=[];this.ca=qa;if(im)try{im(this.aa.bind(this),this.a.bind(this));}catch(jm){this.a(jm);}}var qa=0;function ra(){j.Promise||(j.Promise=pa,j.Promise.resolve=sa,j.Promise.reject=ta,j.Promise.all=ua,j.Promise.race=va,j.setImmediate?(ya=function(im){return j.setImmediate(im);},za=function(im){return j.clearImmediate(im);}):(ya=function(im){return j.setTimeout(im,0);},za=function(im){return j.clearTimeout(im);}));}m("shaka.polyfill.Promise.install",ra);function sa(im){var jm=new pa();jm.aa(im);return jm;}function ta(im){var jm=new pa();jm.a(im);return jm;}function ua(im){function jm(pm,qm,rm){pm.ca==qa&&(mm[qm]=rm,lm++,lm==mm.length&&pm.aa(mm));}var km=new pa();if(!im.length)return km.aa([]),km;for(var lm=0,mm=Array(im.length),nm=km.a.bind(km),om=0;om<im.length;++om)im[om]&&im[om].then?im[om].then(jm.bind(null,km,om),nm):jm(km,om,im[om]);return km;}function va(im){for(var jm=new pa(),km=jm.aa.bind(jm),lm=jm.a.bind(jm),mm=0;mm<im.length;++mm)im[mm]&&im[mm].then?im[mm].then(km,lm):km(im[mm]);return jm;}pa.prototype.then=function(im,jm){var km=new pa();switch(this.ca){case 1:wa(this,km,im);break;case 2:wa(this,km,jm);break;case qa:this.c.push({Na:km,Fa:im}),this.b.push({Na:km,Fa:jm});}return km;};pa.prototype.then=pa.prototype.then;pa.prototype.catch=function(im){return this.then(void 0,im);};pa.prototype["catch"]=pa.prototype.catch;pa.prototype.aa=function(im){if(this.ca==qa){this.Aa=im;this.ca=1;for(im=0;im<this.c.length;++im)wa(this,this.c[im].Na,this.c[im].Fa);this.c=[];this.b=[];}};pa.prototype.a=function(im){if(this.ca==qa){this.Aa=im;this.ca=2;for(im=0;im<this.b.length;++im)wa(this,this.b[im].Na,this.b[im].Fa);this.c=[];this.b=[];}};function wa(im,jm,km){bb.push(function(){if(km&&"function"==typeof km){try{var mm=km(this.Aa);}catch(lm){jm.a(lm);return;}mm instanceof pa?mm==jm?jm.a(new TypeError("Chaining cycle detected")):mm.then(jm.aa.bind(jm),jm.a.bind(jm)):jm.aa(mm);}else 1==this.ca?jm.aa(this.Aa):jm.a(this.Aa);}.bind(im));null==ab&&(ab=ya(xa));}function xa(){for(;bb.length;){null!=ab&&(za(ab),ab=null);var im=bb;bb=[];for(var jm=0;jm<im.length;++jm)im[jm]();}}function ya(){return 0;}function za(){}var ab=null,bb=[];function cb(){var im=HTMLVideoElement.prototype;!im.getVideoPlaybackQuality&&"webkitDroppedFrameCount" in im&&(im.getVideoPlaybackQuality=db);}m("shaka.polyfill.VideoPlaybackQuality.install",cb);function db(){return {droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0};}function eb(im,jm){for(var km=[],lm=0;lm<im.length;++lm){for(var mm=false,nm=0;nm<km.length&&!(mm=jm?jm(im[lm],km[nm]):im[lm]===km[nm]);++nm);mm||km.push(im[lm]);}return km;}function fb(){return Date.now()+gb;}var gb=0;function hb(im){this.b=im;this.c=0==ib;this.a=0;}var ib=1;function jb(im){return im.a<im.b.byteLength;}function kb(im){var jm=im.b.getUint8(im.a);im.a+=1;return jm;}function lb(im){var jm=im.b.getUint32(im.a,im.c);im.a+=4;return jm;}function mb(im){var jm,km;im.c?(jm=im.b.getUint32(im.a,true),km=im.b.getUint32(im.a+4,true)):(km=im.b.getUint32(im.a,false),jm=im.b.getUint32(im.a+4,false));if(2097151<km)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");im.a+=8;return km*Math.pow(2,32)+jm;}function nb(im){if(im.a+16>im.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var jm=new Uint8Array(im.b.buffer,im.a,16);im.a+=16;return jm;}function ob(im,jm){if(im.a+jm>im.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");im.a+=jm;}function pb(im){this.b=im;this.a=new hb(im);qb||(qb=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])]);}var qb;function rb(im){var jm;jm=sb(im);if(7<jm.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var km=0,lm=0;lm<jm.length;lm++)km=256*km+jm[lm];jm=km;km=sb(im);im:{for(lm=0;lm<qb.length;lm++)if(wd(km,qb[lm])){lm=true;break im;}lm=false;};if(lm){km=im.b.byteLength-im.a.a;}else{if(8==km.length&&km[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var lm=km[0]&(1<<8-km.length)-1,mm=1;mm<km.length;mm++)lm=256*lm+km[mm];km=lm;}km=im.a.a+km<=im.b.byteLength?km:im.b.byteLength-im.a.a;lm=new DataView(im.b.buffer,im.b.byteOffset+im.a.a,km);ob(im.a,km);return new tb(jm,lm);}function sb(im){var jm=kb(im.a),km;for(km=1;8>=km&&!(jm&1<<8-km);km++);if(8<km)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var lm=new Uint8Array(km);lm[0]=jm;for(jm=1;jm<km;jm++)lm[jm]=kb(im.a);return lm;}function tb(im,jm){this.id=im;this.a=jm;}function ub(im){if(8<im.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==im.a.byteLength&&im.a.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var jm=0,km=0;km<im.a.byteLength;km++)var lm=im.a.getUint8(km),jm=256*jm+lm;return jm;}var vb={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function wb(im){this.c=Math.exp(Math.log(.5)/im);this.a=this.b=0;}wb.prototype.sample=function(im,jm){var km=Math.pow(this.c,im);this.b=jm*(1-km)+km*this.b;this.a+=im;};function xb(im){return im.b/(1-Math.pow(im.c,im.a));}function yb(im){var jm=new CustomEvent(im.type,{detail:im.detail,bubbles:!!im.bubbles}),km;for(km in im)km in jm||(jm[km]=im[km]);return jm;}function zb(im){return new CustomEvent("error",{detail:im,bubbles:true});}function ac(im,jm,km){dc(jm);dc(km);return km==jm||im>=bc&&km==jm.split("-")[0]||im>=cc&&km.split("-")[0]==jm.split("-")[0]?true:false;}var bc=1,cc=2;function dc(im){im=im.toLowerCase().split("-");var jm=ec[im[0]];jm&&(im[0]=jm);return im.join("-");}var ec={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function fc(im){return Object.keys(im).map(function(jm){return im[jm];});}function gc(im,jm){return jc(im,jm,"boolean");}function hc(im,jm,km){im=jc(im,jm,"number");if(null==im)return null;if(isNaN(im)||im==Number.NEGATIVE_INFINITY||im==Number.POSITIVE_INFINITY)throw new RangeError("'"+jm+"' must be finite.");if(null!=km&&im<km)throw new RangeError("'"+jm+"' must be >= "+km);return im;}function ic(im,jm){return jc(im,jm,"string");}function jc(im,jm,km){im=im[jm];if(null==im)return null;if(typeof im!=km)throw new TypeError("'"+jm+"' must be a "+km+".");return im;}function kc(im,jm,km){im=im[jm];if(null==im)return null;if(!(im instanceof km))throw new TypeError("'"+jm+"' must be an instance of "+km.name+".");return im;}function lc(){this.a={};}lc.prototype.push=function(im,jm){this.a.hasOwnProperty(im)?this.a[im].push(jm):this.a[im]=[jm];};lc.prototype.set=function(im,jm){this.a[im]=jm;};lc.prototype.get=function(im){return (im=this.a[im])?im.slice():null;};function mc(im){var jm=[],km;for(km in im.a)jm.push.apply(jm,im.a[km]);return jm;}function nc(im,jm,km){if(im=im.a[jm])for(jm=0;jm<im.length;++jm)im[jm]==km&&(im.splice(jm,1),--jm);}function oc(im){var jm=[],km;for(km in im.a)jm.push(km);return jm;}function pc(){this.a=new lc();}pc.prototype.destroy=function(){rc(this);this.a=null;};function qc(im,jm,km,lm){jm=new sc(jm,km,lm);im.a.push(km,jm);}pc.prototype.va=function(im,jm){for(var km=this.a.get(jm)||[],lm=0;lm<km.length;++lm){var mm=km[lm];mm.target==im&&(mm.va(),nc(this.a,jm,mm));}};function rc(im){for(var jm=mc(im.a),km=0;km<jm.length;++km)jm[km].va();im.a.a={};}function sc(im,jm,km){this.target=im;this.type=jm;this.a=km;this.target.addEventListener(jm,km,false);}sc.prototype.va=function(){this.target&&(this.target.removeEventListener(this.type,this.a,false),this.a=this.target=null);};function tc(im){this.Ba=new lc();this.S=im;}m("shaka.util.FakeEventTarget",tc);tc.prototype.addEventListener=function(im,jm,km){km||this.Ba.push(im,jm);};tc.prototype.removeEventListener=function(im,jm,km){km||nc(this.Ba,im,jm);};tc.prototype.dispatchEvent=function(im){im.hasOwnProperty("srcElement")||(delete im.srcElement,Object.defineProperty(im,"srcElement",{get:function(){return null;}}));if(im.hasOwnProperty("target")){im.target=this;}else{delete im.target;var jm=this;Object.defineProperty(im,"target",{get:function(){return jm;},set:function(lm){jm=lm;}});}if(im.hasOwnProperty("currentTarget")){im.currentTarget=null;}else{delete im.currentTarget;var km=null;Object.defineProperty(im,"currentTarget",{get:function(){return km;},set:function(lm){km=lm;}});}return uc(this,im);};tc.prototype.X=function(im,jm){return this.dispatchEvent(yb({type:"debug/shakaEvent",bubbles:true,detail:{type:im,event:jm}}));};function uc(im,jm){jm.currentTarget=im;for(var km=im.Ba.get(jm.type)||[],lm=0;lm<km.length;++lm){var mm=km[lm];try{mm.handleEvent?mm.handleEvent(jm):mm.call(im,jm);}catch(nm){}}im.S&&jm.bubbles&&uc(im.S,jm);return jm.defaultPrevented;}function vc(im){tc.call(this,null);this.a=new wb(3);this.g=new wb(10);this.h=im||500000;this.f=0;}n(vc,tc);m("shaka.util.EWMABandwidthEstimator",vc);vc.prototype.sample=function(im,jm){if(!(65536>jm)){im=Math.max(im,50);var km=8000*jm/im,lm=im/1000;this.a.sample(lm,km);this.g.sample(lm,km);this.dispatchEvent(yb({type:"bandwidth"}));this.f=Date.now();}};vc.prototype.getBandwidth=function(){return .5>this.a.a?this.h:Math.min(xb(this.a),xb(this.g));};vc.prototype.getDataAge=function(){return (Date.now()-this.f)/1000;};vc.prototype.supportsCaching=function(){return false;};function wc(im,jm,km){vc.call(this,km);this.c=im||0;this.b=void 0===jm?Infinity:jm;}n(wc,vc);m("shaka.util.EWMACacheBandwidthEstimator",wc);wc.prototype.sample=function(im,jm){im<=this.c&&8000*jm/im>this.b||vc.prototype.sample.call(this,im,jm);};wc.prototype.supportsCaching=function(){return Infinity!==this.b&&!!this.c;};function xc(){vc.call(this);}n(xc,vc);m("shaka.util.EWMASignedURLBandwidthEstimator",xc);xc.prototype.supportsCaching=function(){return true;};function yc(){var im,jm,km=new h(function(lm,mm){im=lm;jm=mm;});km.resolve=im;km.reject=jm;km.destroy=yc.prototype.destroy;return km;}yc.prototype.destroy=function(){this.catch(function(){});var im=Error("Destroyed!");im.type="destroy";this.reject(im);};function zc(im){im.split("").reduce(function(jm,km,lm){return jm+(lm&&0==lm%4?" "+km:km);});}function ad(){this.za=new yc();this.c=false;this.$=null;this.a=[];this.b=null;}function bd(im,jm){if(im.c)throw Error("Cannot append to a running task!");im.a.push(jm);}ad.prototype.start=function(){if(this.c)throw Error("Task already started!");this.c=true;this.a.unshift(function(){});cd(this,void 0);};ad.prototype.end=function(){this.a.splice(1);};function cd(im,jm){var km=im.a[0](jm),lm;km?(lm=km[0],im.b=km[1]):(lm=h.resolve(),im.b=null);lm.then(ed(im,function(mm){this.$?(this.a=[],this.b=null,dd(this)):(this.a.shift(),this.a.length?cd(this,mm):(this.za.resolve(mm),this.b=null));})).catch(ed(im,function(mm){this.a=[];this.b=null;this.$?dd(this):this.za.reject(mm);}));}function dd(im){function jm(){var km=Error("Task aborted.");km.type="aborted";this.za.reject(km);j.setTimeout(function(){this.$.resolve();this.$=null;}.bind(this),5);}im.f?im.f.then(function(){this.f=null;jm.call(this);}.bind(im)):jm.call(im);}function ed(im,jm){return jm.bind(im);}function fd(im,jm,km,lm){MediaSource.isTypeSupported(jm);tc.call(this,lm);jm=im.addSourceBuffer(jm);this.i=im;this.f=jm;this.m=km;this.j=new pc();this.B=null;this.A=false;this.b=[];this.v=0;this.h=this.c=this.a=null;this.s=0;qc(this.j,this.f,"updateend",this.C.bind(this));}n(fd,tc);var gd=1/60;fd.prototype.destroy=function(){md(this).catch(function(){});this.c&&this.c.destroy();this.b=this.a=this.c=null;this.j.destroy();this.i=this.f=this.j=null;};function hd(im,jm){for(var km=im.f.buffered,lm=0;lm<km.length;++lm){var mm=km.start(lm)-gd,nm=km.end(lm)+gd;if(jm>=mm&&jm<=nm)return km.end(lm)-jm;}return 0;}function id(im,jm,km){jm=jm.endTime?jm.endTime-jm.startTime:1;var lm=new dh();lm.a=3;lm.i=1000*jm;lm.c=1000*im.s;lm.m=im.B;lm.j=km;return lm;}function jd(im,jm,km,lm,mm){if(im.a)return im=Error("Cannot fetch ("+im.l+"): previous operation not complete."),im.type="stream",h.reject(im);im.a=new ad();km!=im.f.timestampOffset&&(im.f.timestampOffset=km);km=id(im,jm,mm);var nm=oh(jm.url,km,im.m);im.X("SegmentFetching",jm);var om=lh.prototype.f.bind(jm.url),pm=0;lm&&bd(im.a,function(){return [lm.then(function(sm){sm.ja>pm&&(pm=sm.ja);return qd(this,sm,null);}.bind(this)),this.g.bind(this)];}.bind(im));bd(im.a,ed(im,function(){return [nm.then(function(sm){this.X("SegmentFetched",jm);sm.ja>pm&&(pm=sm.ja);this.m.getBandwidth();return qd(this,sm,jm);}.bind(this)),function(){this.X("SegmentFailed",jm);om();return this.g();}.bind(this)];}));var qm=0==im.f.buffered.length&&0==im.b.length,rm=null;bd(im.a,function(){if(0==this.f.buffered.length){var sm=Error("Failed to buffer segment ("+this.l+").");sm.type="stream";return [h.reject(sm)];}qm&&(sm=jm.startTime,rm=this.f.buffered.start(0)-sm);sm=ai(this.b,jm.startTime);0<=sm?this.b.splice(sm+1,0,jm):this.b.push(jm);}.bind(im));return pd(im).then(function(){return h.resolve({Z:rm,wb:pm});}.bind(im));}function kd(im){if(im.a)return im=Error("Cannot clear ("+im.l+"): previous operation not complete."),im.type="stream",h.reject(im);im.a=new ad();bd(im.a,function(){var jm;jm:if(0==this.f.buffered.length){jm=h.resolve();}else{try{this.f.remove(0,this.i.duration);}catch(km){jm=h.reject(km);break jm;}this.b=[];jm=this.c=new yc();};return [jm,this.g.bind(this)];}.bind(im));return pd(im);}function ld(im,jm){if(im.a){var km=Error("Cannot clearAfter ("+im.l+"): previous operation not complete.");km.type="stream";return h.reject(km);}im.a=new ad();bd(im.a,function(){return [rd(this,jm),this.g.bind(this)];}.bind(im));return pd(im);}function md(im){im.a?(im=im.a,im.$?im=im.$:im.c?(im.b&&(im.f=im.b()),im.$=new yc(),im=im.$):(im.c=true,im=h.resolve())):im=h.resolve();return im;}function nd(im){for(var jm=im.currentTime,km=jm,lm=0;lm<im.buffered.length;lm++)if(jm<=im.buffered.start(lm)){km=im.buffered.start(lm);break;}return km;}function od(im){for(var jm=im.currentTime,km=0;km<im.buffered.length;km++)if(jm>=im.buffered.start(km)&&jm<=im.buffered.end(km)-.05)return false;return true;}function pd(im){im.a.start();return im.a.za.then(ed(im,function(){this.a=null;})).catch(ed(im,function(jm){this.a=null;return h.reject(jm);}));}function qd(im,jm,km){try{im.f.appendBuffer(jm);}catch(lm){return h.reject(lm);}im.c=new yc();im.h=km;return im.c;}function rd(im,jm){if(0==im.f.buffered.length)return h.resolve();var km=ai(im.b,jm);if(-1==km||km==im.b.length-1)return h.resolve();try{im.f.remove(im.b[km+1].startTime,im.i.duration);}catch(lm){return h.reject(lm);}im.b=im.b.slice(0,km+1);im.c=new yc();return im.c;}fd.prototype.g=function(){if(this.c){if("open"==this.i.readyState){var im=Error("Previous operation aborted.");im.type="abort";this.c.reject(im);this.A||this.f.abort();this.c=new yc();}return this.c;}return h.resolve();};fd.prototype.C=function(){this.c&&(this.h&&(this.X("SegmentAppended",this.h),this.h=null),this.c.resolve(),this.c=null);};function sd(im){return String.fromCharCode.apply(null,im);}m("shaka.util.Uint8ArrayUtils.toString",sd);function td(im){for(var jm=new Uint8Array(im.length),km=0;km<im.length;++km)jm[km]=im.charCodeAt(km);return jm;}m("shaka.util.Uint8ArrayUtils.fromString",td);m("shaka.util.Uint8ArrayUtils.toBase64",function(im,jm){var km=void 0==jm?true:jm,lm=j.btoa(sd(im)).replace(/\+/g,"-").replace(/\//g,"_");return km?lm:lm.replace(/=*$/,"");});function ud(im){return td(j.atob(im.replace(/-/g,"+").replace(/_/g,"/")));}m("shaka.util.Uint8ArrayUtils.fromBase64",ud);m("shaka.util.Uint8ArrayUtils.fromHex",function(im){for(var jm=new Uint8Array(im.length/2),km=0;km<im.length;km+=2)jm[km/2]=j.parseInt(im.substr(km,2),16);return jm;});function vd(im){for(var jm="",km=0;km<im.length;++km){var lm=im[km].toString(16);1==lm.length&&(lm="0"+lm);jm+=lm;}return jm;}m("shaka.util.Uint8ArrayUtils.toHex",vd);function wd(im,jm){if(!im&&!jm)return true;if(!im||!jm||im.length!=jm.length)return false;for(var km=0;km<im.length;++km)if(im[km]!=jm[km])return false;return true;}function xd(){this.h=this.a="";this.l=false;this.s=this.m=null;this.i=this.g=false;this.j=this.f="";this.c=null;this.b=[];}function yd(im,jm){var km=new xd();km.a=im.a;km.h=im.h;km.l=im.l;km.m=im.m;km.s=im.s;km.g=im.g;km.i=im.i;km.f=im.f;km.j=im.j;km.c=im.c?new Uint8Array(im.c.buffer):null;zd(km,im.b);zd(km,jm.b);return km;}function zd(im,jm){var km=im.b.concat(jm.map(function(lm){return {initData:new Uint8Array(lm.initData.buffer),initDataType:lm.initDataType};}));im.b=eb(km,ae);}function ae(im,jm){return im.initDataType==jm.initDataType&&wd(im.initData,jm.initData);}function be(im,jm,km,lm){this.a=[];lm&&this.a.push(lm);}m("shaka.player.DrmSchemeInfo",be);be.DistinctiveIdentifier={OPTIONAL:0,REQUIRED:1};be.PersistentState={OPTIONAL:0,REQUIRED:1};be.createUnencrypted=function(){return new be(0,0,0,null);};function ce(im,jm){try{var lm=new ee(im,jm);return h.resolve(lm);}catch(km){return h.reject(km);}}function de(im){var jm=this.mediaKeys;jm&&jm!=im&&ge(jm,null);delete this.mediaKeys;(this.mediaKeys=im)&&ge(im,this);return h.resolve();}function ee(im,jm){this.a=this.keySystem=im;var km=true;"org.w3.clearkey"==im&&(this.a="webkit-org.w3.clearkey",km=false);var lm=false,mm;mm=document.getElementsByTagName("video");mm=mm.length?mm[0]:document.createElement("video");for(var nm=0;nm<jm.length;++nm){var om=jm[nm],pm={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:om.initDataTypes,sessionTypes:["temporary"]},qm=false;if(om.audioCapabilities)for(var rm=0;rm<om.audioCapabilities.length;++rm){var sm=om.audioCapabilities[rm];sm.contentType&&(qm=true,mm.canPlayType(sm.contentType.split(";")[0],this.a)&&(pm.audioCapabilities.push(sm),lm=true));}if(om.videoCapabilities)for(rm=0;rm<om.videoCapabilities.length;++rm)sm=om.videoCapabilities[rm],sm.contentType&&(qm=true,mm.canPlayType(sm.contentType,this.a)&&(pm.videoCapabilities.push(sm),lm=true));qm||(lm=mm.canPlayType("video/mp4",this.a)||mm.canPlayType("video/webm",this.a));"required"==om.persistentState&&(km?(pm.persistentState="required",pm.sessionTypes=["persistent-license"]):lm=false);if(lm){this.b=pm;return;}}km="Unsupported keySystem";if("org.w3.clearkey"==im||"com.widevine.alpha"==im)km="None of the requested configurations were supported.";km=Error(km);km.name="NotSupportedError";km.code=DOMException.NOT_SUPPORTED_ERR;throw km;}ee.prototype.createMediaKeys=function(){var im=new fe(this.a);return h.resolve(im);};ee.prototype.getConfiguration=function(){return this.b;};function fe(im){this.g=im;this.b=null;this.a=new pc();this.c=[];this.f={};}function ge(im,jm){im.b=jm;rc(im.a);jm&&(qc(im.a,jm,"webkitneedkey",im.Pb.bind(im)),qc(im.a,jm,"webkitkeymessage",im.Ob.bind(im)),qc(im.a,jm,"webkitkeyadded",im.Mb.bind(im)),qc(im.a,jm,"webkitkeyerror",im.Nb.bind(im)));}k=fe.prototype;k.createSession=function(im){var jm=im||"temporary";if("temporary"!=jm&&"persistent-license"!=jm)throw new TypeError("Session type "+im+" is unsupported on this platform.");im=this.b||document.createElement("video");im.src||(im.src="about:blank");jm=new ie(im,this.g,jm);this.c.push(jm);return jm;};k.setServerCertificate=function(){return h.reject(Error("setServerCertificate not supported on this platform."));};k.Pb=function(im){im=yb({type:"encrypted",initDataType:"webm",initData:im.initData});this.b.dispatchEvent(im);};k.Ob=function(im){var jm=he(this,im.sessionId);jm&&(im=yb({type:"message",messageType:void 0==jm.keyStatuses.Ka()?"licenserequest":"licenserenewal",message:im.message}),jm.b&&(jm.b.resolve(),jm.b=null),jm.dispatchEvent(im));};k.Mb=function(im){if(im=he(this,im.sessionId))ke(im,"usable"),im.a&&im.a.resolve(),im.a=null;};k.Nb=function(im){var jm=he(this,im.sessionId);if(jm){var km=Error("EME v0.1b key error");km.errorCode=im.errorCode;km.errorCode.systemCode=im.systemCode;!im.sessionId&&jm.b?(km.method="generateRequest",45==im.systemCode&&(km.message="Unsupported session type."),jm.b.reject(km),jm.b=null):im.sessionId&&jm.a?(km.method="update",jm.a.reject(km),jm.a=null):(km=im.systemCode,im.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?ke(jm,"output-restricted"):1==km?ke(jm,"expired"):ke(jm,"internal-error"));}};function he(im,jm){var km=im.f[jm];return km?km:(km=im.c.shift())?(km.sessionId=jm,im.f[jm]=km):null;}function ie(im,jm,km){tc.call(this,null);this.f=im;this.h=false;this.a=this.b=null;this.c=jm;this.g=km;this.sessionId="";this.expiration=NaN;this.closed=new yc();this.keyStatuses=new le();}n(ie,tc);function je(im,jm,km){if(im.h)return h.reject(Error("The session is already initialized."));im.h=true;var lm;try{if("persistent-license"==im.g){if(km){lm=td("LOAD_SESSION|"+km);}else{var nm=new Uint8Array(jm);lm=td("PERSISTENT|"+sd(nm));}}else lm=new Uint8Array(jm);}catch(mm){return h.reject(mm);}im.b=new yc();try{im.f.webkitGenerateKeyRequest(im.c,lm);}catch(om){if("InvalidStateError"!=om.name)return im.b=null,h.reject(om);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,lm);}catch(pm){this.b.reject(pm),this.b=null;}}.bind(im),10);}return im.b;}k=ie.prototype;k.Ra=function(im,jm){if(this.a){this.a.then(this.Ra.bind(this,im,jm)).catch(this.Ra.bind(this,im,jm));}else{this.a=im;var km,lm;"webkit-org.w3.clearkey"==this.c?(km=sd(new Uint8Array(jm)),lm=JSON.parse(km),"oct"!=lm.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),km=ud(lm.keys[0].k),lm=ud(lm.keys[0].kid)):(km=new Uint8Array(jm),lm=null);try{this.f.webkitAddKey(this.c,km,lm,this.sessionId);}catch(mm){this.a.reject(mm),this.a=null;}}};function ke(im,jm){im.keyStatuses.Pa(jm);var km=yb({type:"keystatuseschange"});im.dispatchEvent(km);}k.generateRequest=function(im,jm){return je(this,jm,null);};k.load=function(im){return "persistent-license"==this.g?je(this,null,im):h.reject(Error("Not a persistent session."));};k.update=function(im){var jm=new yc();this.Ra(jm,im);return jm;};k.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId);}this.closed.resolve();return this.closed;};k.remove=function(){return "persistent-license"!=this.g?h.reject(Error("Not a persistent session.")):this.close();};function le(){this.size=0;this.a=void 0;}var me;k=le.prototype;k.Pa=function(im){this.size=void 0==im?0:1;this.a=im;};k.Ka=function(){return this.a;};k.forEach=function(im){this.a&&im(me,this.a);};k.get=function(im){if(this.has(im))return this.a;};k.has=function(im){var jm=me;return this.a&&wd(new Uint8Array(im),new Uint8Array(jm))?true:false;};function ne(im){this.systemIds=[];this.cencKeyIds=[];this.a=[];im=new hb(new DataView(im.buffer));try{for(;jb(im);){var km=im.a,lm=lb(im),mm=lb(im);1==lm?lm=mb(im):0==lm&&(lm=im.b.byteLength-km);if(1886614376!=mm){ob(im,lm-(im.a-km));}else{var nm=kb(im);if(1<nm){ob(im,lm-(im.a-km));}else{ob(im,3);var om=vd(nb(im)),pm=[];if(0<nm)for(var qm=lb(im),rm=0;rm<qm;++rm){var sm=vd(nb(im));pm.push(sm);}var tm=lb(im);ob(im,tm);this.cencKeyIds.push.apply(this.cencKeyIds,pm);this.systemIds.push(om);this.a.push({start:km,end:im.a-1});im.a!=km+lm&&ob(im,lm-(im.a-km));}}}}catch(jm){}}function oe(im,jm){try{var lm=new pe(im,jm);return h.resolve(lm);}catch(km){return h.reject(km);}}function pe(im,jm){this.keySystem=im;for(var km=false,lm=0;lm<jm.length;++lm){var mm=jm[lm],nm={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:mm.initDataTypes,sessionTypes:["temporary"]},om=false;if(mm.audioCapabilities)for(var pm=0;pm<mm.audioCapabilities.length;++pm){var qm=mm.audioCapabilities[pm];if(qm.contentType){var om=true,rm=qm.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,rm)&&(nm.audioCapabilities.push(qm),km=true);}}if(mm.videoCapabilities)for(pm=0;pm<mm.videoCapabilities.length;++pm)qm=mm.videoCapabilities[pm],qm.contentType&&(om=true,rm=qm.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,rm)&&(nm.videoCapabilities.push(qm),km=true));om||(km=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==mm.persistentState&&(nm.persistentState="required",nm.sessionTypes=["persistent-license"]);if(km){this.a=nm;return;}}km=Error("Unsupported keySystem");km.name="NotSupportedError";km.code=DOMException.NOT_SUPPORTED_ERR;throw km;}pe.prototype.createMediaKeys=function(){var im=new re(this.keySystem);return h.resolve(im);};pe.prototype.getConfiguration=function(){return this.a;};function qe(im){var jm=this.mediaKeys;jm&&jm!=im&&se(jm,null);delete this.mediaKeys;return (this.mediaKeys=im)?se(im,this):h.resolve();}function re(im){this.a=new MSMediaKeys(im);this.b=new pc();}re.prototype.createSession=function(im){if("temporary"!=(im||"temporary"))throw new TypeError("Session type "+im+" is unsupported on this platform.");return new te(this.a);};re.prototype.setServerCertificate=function(){return h.reject(Error("setServerCertificate not supported on this platform."));};function se(im,jm){function km(){jm.msSetMediaKeys(lm.a);jm.removeEventListener("loadedmetadata",km);}rc(im.b);if(!jm)return h.resolve();qc(im.b,jm,"msneedkey",ue);var lm=im;try{return 1<=jm.readyState?jm.msSetMediaKeys(im.a):jm.addEventListener("loadedmetadata",km),h.resolve();}catch(mm){return h.reject(mm);}}function te(im){tc.call(this,null);this.c=null;this.g=im;this.b=this.a=null;this.f=new pc();this.sessionId="";this.expiration=NaN;this.closed=new yc();this.keyStatuses=new xe();}n(te,tc);k=te.prototype;k.generateRequest=function(im,jm){this.a=new yc();try{this.c=this.g.createSession("video/mp4",new Uint8Array(jm),null),qc(this.f,this.c,"mskeymessage",this.Eb.bind(this)),qc(this.f,this.c,"mskeyadded",this.Cb.bind(this)),qc(this.f,this.c,"mskeyerror",this.Db.bind(this)),we(this,"status-pending");}catch(km){this.a.reject(km);}return this.a;};k.load=function(){return h.reject(Error("MediaKeySession.load not yet supported"));};k.update=function(im){this.b=new yc();try{this.c.update(new Uint8Array(im));}catch(jm){this.b.reject(jm);}return this.b;};k.close=function(){try{this.c.close(),this.closed.resolve(),rc(this.f);}catch(im){this.closed.reject(im);}return this.closed;};k.remove=function(){return h.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"));};function ue(im){var jm=im.initData;if(jm){var km=new ne(jm);if(1>=km.a.length){im=jm;}else{var lm=[];for(im=0;im<km.a.length;im++)lm.push(jm.subarray(km.a[im].start,km.a[im].end+1));jm=eb(lm,ve);for(im=km=0;im<jm.length;im++)km+=jm[im].length;km=new Uint8Array(km);for(im=lm=0;im<jm.length;im++)km.set(jm[im],lm),lm+=jm[im].length;im=km;}}else im=jm;im=yb({type:"encrypted",initDataType:"cenc",initData:im});this.dispatchEvent(im);}function ve(im,jm){return wd(im,jm);}k.Eb=function(im){this.a&&(this.a.resolve(),this.a=null);im=yb({type:"message",messageType:void 0==this.keyStatuses.Ka()?"licenserequest":"licenserenewal",message:im.message.buffer});this.dispatchEvent(im);};k.Cb=function(){this.a?(this.a.resolve(),this.a=null):this.b&&(we(this,"usable"),this.b.resolve(),this.b=null);};k.Db=function(){var im=Error("EME v20140218 key error");im.errorCode=this.c.error;if(null!=this.a){this.a.reject(im),this.a=null;}else if(null!=this.b){this.b.reject(im),this.b=null;}else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:we(this,"output-not-allowed");default:we(this,"internal-error");}};function we(im,jm){im.keyStatuses.Pa(jm);var km=yb({type:"keystatuseschange"});im.dispatchEvent(km);}function xe(){this.size=0;this.a=void 0;}var ye;k=xe.prototype;k.Pa=function(im){this.size=void 0==im?0:1;this.a=im;};k.Ka=function(){return this.a;};k.forEach=function(im){this.a&&im(ye,this.a);};k.get=function(im){if(this.has(im))return this.a;};k.has=function(im){var jm=ye;return this.a&&wd(new Uint8Array(im),new Uint8Array(jm))?true:false;};function ze(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(me=(new Uint8Array([0])).buffer,Navigator.prototype.requestMediaKeySystemAccess=ce,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=de,j.MediaKeys=fe,j.MediaKeySystemAccess=ee):j.MSMediaKeys?(ye=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=qe,j.MediaKeys=re,j.MediaKeySystemAccess=pe,Navigator.prototype.requestMediaKeySystemAccess=oe):(Navigator.prototype.requestMediaKeySystemAccess=la,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=ma,j.MediaKeys=na,j.MediaKeySystemAccess=oa));}m("shaka.polyfill.MediaKeys.install",ze);m("shaka.polyfill.installAll",function(){ha();ja();cb();ra();ze();});var af=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function bf(im){var jm;im instanceof bf?(cf(this,im.Y),this.da=im.da,this.N=im.N,df(this,im.ia),this.R=im.R,ef(this,im.a.clone()),this.ba=im.ba):im&&(jm=String(im).match(af))?(cf(this,jm[1]||"",true),this.da=ff(jm[2]||""),this.N=ff(jm[3]||"",true),df(this,jm[4]),this.R=ff(jm[5]||"",true),ef(this,jm[6]||"",true),this.ba=ff(jm[7]||"")):this.a=new of(null);}k=bf.prototype;k.Y="";k.da="";k.N="";k.ia=null;k.R="";k.ba="";k.toString=function(){var im=[],jm=this.Y;jm&&im.push(gf(jm,jf,true),":");if(jm=this.N){im.push("//");var km=this.da;km&&im.push(gf(km,jf,true),"@");im.push(encodeURIComponent(jm).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));jm=this.ia;null!=jm&&im.push(":",String(jm));}if(jm=this.R)this.N&&"/"!=jm.charAt(0)&&im.push("/"),im.push(gf(jm,"/"==jm.charAt(0)?lf:kf,true));(jm=this.a.toString())&&im.push("?",jm);(jm=this.ba)&&im.push("#",gf(jm,nf));return im.join("");};k.resolve=function(im){var jm=this.clone();"data"===jm.Y&&(jm=new bf());var km=!!im.Y;km?cf(jm,im.Y):km=!!im.da;km?jm.da=im.da:km=!!im.N;km?jm.N=im.N:km=null!=im.ia;var lm=im.R;if(km){df(jm,im.ia);}else if(km=!!im.R){if("/"!=lm.charAt(0))if(this.N&&!this.R){lm="/"+lm;}else{var mm=jm.R.lastIndexOf("/");-1!=mm&&(lm=jm.R.substr(0,mm+1)+lm);}if(".."==lm||"."==lm){lm="";}else if(-1!=lm.indexOf("./")||-1!=lm.indexOf("/.")){for(var mm=0==lm.lastIndexOf("/",0),lm=lm.split("/"),nm=[],om=0;om<lm.length;){var pm=lm[om++];"."==pm?mm&&om==lm.length&&nm.push(""):".."==pm?((1<nm.length||1==nm.length&&""!=nm[0])&&nm.pop(),mm&&om==lm.length&&nm.push("")):(nm.push(pm),mm=true);}lm=nm.join("/");}}km?jm.R=lm:km=""!==im.a.toString();km?ef(jm,im.a.clone()):km=!!im.ba;km&&(jm.ba=im.ba);return jm;};k.clone=function(){return new bf(this);};function cf(im,jm,km){im.Y=km?ff(jm,true):jm;im.Y&&(im.Y=im.Y.replace(/:$/,""));}function df(im,jm){if(jm){jm=Number(jm);if(isNaN(jm)||0>jm)throw Error("Bad port number "+jm);im.ia=jm;}else im.ia=null;}function ef(im,jm,km){jm instanceof of?im.a=jm:(km||(jm=gf(jm,mf)),im.a=new of(jm));}function ff(im,jm){return im?jm?decodeURI(im):decodeURIComponent(im):"";}function gf(im,jm,km){return "string"==typeof im?(im=encodeURI(im).replace(jm,hf),km&&(im=im.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),im):null;}function hf(im){im=im.charCodeAt(0);return "%"+(im>>4&15).toString(16)+(im&15).toString(16);}var jf=/[#\/\?@]/g,kf=/[\#\?:]/g,lf=/[\#\?]/g,mf=/[\#\?@]/g,nf=/#/g;function of(im){this.b=im||null;}of.prototype.a=null;of.prototype.c=null;function pf(im,jm,km){if(!im.a&&(im.a={},im.c=0,im.b))for(var lm=im.b.split("&"),mm=0;mm<lm.length;mm++){var nm=lm[mm].indexOf("="),om=null,pm=null;0<=nm?(om=lm[mm].substring(0,nm),pm=lm[mm].substring(nm+1)):om=lm[mm];om=decodeURIComponent(om.replace(/\+/g," "));pm=pm||"";pf(im,om,decodeURIComponent(pm.replace(/\+/g," ")));}im.b=null;(lm=im.a.hasOwnProperty(jm)&&im.a[jm])||(im.a[jm]=lm=[]);lm.push(km);im.c++;}of.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return "";var im=[],jm;for(jm in this.a)for(var km=encodeURIComponent(jm),lm=this.a[jm],mm=0;mm<lm.length;mm++){var nm=km;""!==lm[mm]&&(nm+="="+encodeURIComponent(lm[mm]));im.push(nm);}return this.b=im.join("&");};of.prototype.clone=function(){var im=new of();im.b=this.b;if(this.a){var jm={},km;for(km in this.a)jm[km]=this.a[km].concat();im.a=jm;im.c=this.c;}return im;};function qf(im,jm,km){im=(new DOMParser()).parseFromString(im,"text/xml");if(!im)return null;jm=jm||[new bf("")];km=km||[new bf("")];return og({qb:jm,u:km},im,rf);}m("shaka.dash.mpd.parseMpd",qf);function rf(){this.id=this.url=null;this.type="static";this.b=this.j=this.u=this.qb=null;this.h=5;this.f=this.c=this.g=null;this.i=1;this.a=[];}function sf(){this.g=this.f=this.c=this.u=this.a=this.start=this.id=null;this.b=[];}function tf(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=false;this.h=this.g=this.f=this.u=null;this.j=[];this.a=[];}function uf(){this.value=null;}function vf(){this.contentType=this.lang=this.id=null;}function wf(){this.a=this.b=this.g=this.u=this.fbQualityClass=this.fbQualityLabel=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.c=[];}function xf(){this.b=this.a=this.c=this.f=null;}function yf(){this.parsedPssh=this.psshBox=null;}function zf(){this.url=null;}function ag(){this.url=null;}function bg(){this.u=null;this.h=1;this.c=this.b=this.f=this.a=this.g=null;}bg.prototype.clone=function(){var im=new bg();im.u=sg(this.u);im.h=this.h;im.g=this.g;im.a=tg(this.a);im.f=tg(this.f);im.b=tg(this.b);im.c=tg(this.c);return im;};function cg(){this.a=this.url=null;}cg.prototype.clone=function(){var im=new cg();im.url=sg(this.url);im.a=tg(this.a);return im;};function dg(){this.a=this.url=null;}dg.prototype.clone=function(){var im=new dg();im.url=sg(this.url);im.a=tg(this.a);return im;};function eg(){this.u=null;this.a=1;this.c=this.g=null;this.i=0;this.h=null;this.b=[];this.f=null;}eg.prototype.clone=function(){var im=new eg();im.u=sg(this.u);im.a=this.a;im.g=this.g;im.c=this.c;im.i=this.i;im.h=tg(this.h);im.b=sg(this.b)||[];im.f=tg(this.f);return im;};function fg(){this.a=this.b=null;}fg.prototype.clone=function(){var im=new fg();im.b=sg(this.b);im.a=tg(this.a);return im;};function gg(){this.a=1;this.b=this.i=null;this.j=0;this.c=this.g=this.f=this.h=null;}gg.prototype.clone=function(){var im=new gg();im.a=this.a;im.i=this.i;im.b=this.b;im.j=this.j;im.h=this.h;im.f=this.f;im.g=this.g;im.c=tg(this.c);return im;};function hg(){this.a=[];}hg.prototype.clone=function(){var im=new hg();im.a=sg(this.a)||[];return im;};function ig(){this.b=this.a=this.startTime=null;}ig.prototype.clone=function(){var im=new ig();im.startTime=this.startTime;im.a=this.a;im.b=this.b;return im;};function jg(im,jm){this.ha=im;this.end=jm;}jg.prototype.clone=function(){return new jg(this.ha,this.end);};rf.TAG_NAME="MPD";sf.TAG_NAME="Period";tf.TAG_NAME="AdaptationSet";uf.TAG_NAME="Role";vf.TAG_NAME="ContentComponent";wf.TAG_NAME="Representation";xf.TAG_NAME="ContentProtection";yf.TAG_NAME="cenc:pssh";zf.TAG_NAME="BaseURL";ag.TAG_NAME="Location";bg.TAG_NAME="SegmentBase";cg.TAG_NAME="RepresentationIndex";dg.TAG_NAME="Initialization";eg.TAG_NAME="SegmentList";fg.TAG_NAME="SegmentURL";gg.TAG_NAME="SegmentTemplate";hg.TAG_NAME="SegmentTimeline";ig.TAG_NAME="S";rf.prototype.parse=function(im,jm){this.url=im.qb;this.id=ug(jm,"id",bh);this.type=ug(jm,"type",bh)||"static";this.b=ug(jm,"mediaPresentationDuration",wg);this.h=ug(jm,"minBufferTime",wg,this.h);this.g=ug(jm,"minimumUpdatePeriod",wg,this.g);this.c=ug(jm,"availabilityStartTime",vg,this.c);this.f=ug(jm,"timeShiftBufferDepth",wg,this.f);this.f=null;this.i=ug(jm,"suggestedPresentationDelay",wg,this.i);var km=im.u,lm=qg(this,jm,zf);this.u=lg(km,lm);if(lm=og(this,jm,ag))this.j=mg(km,lm.url);this.a=qg(this,jm,sf);};sf.prototype.parse=function(im,jm){this.id=ug(jm,"id",bh);this.start=ug(jm,"start",wg);this.a=ug(jm,"duration",wg);var km=qg(this,jm,zf);this.u=lg(im.u,km);this.c=og(this,jm,bg);this.f=og(this,jm,eg);this.g=og(this,jm,gg);this.b=qg(this,jm,tf);kg(this);};function kg(im){for(var jm=[],km=0;km<im.b.length;++km){var lm=im.b[km];null!=lm.group&&(jm[lm.group]=true);}for(km=0;km<im.b.length;++km)if(lm=im.b[km],null==lm.group){for(var mm=1;1==jm[mm];)++mm;jm[mm]=true;lm.group=mm;}}tf.prototype.parse=function(im,jm){var km=og(this,jm,vf)||{},lm=og(this,jm,uf);this.id=ug(jm,"id",bh);this.group=ug(jm,"group",ah);this.lang=ug(jm,"lang",bh,km.lang);this.contentType=ug(jm,"contentType",bh,km.contentType);this.width=ug(jm,"width",zg);this.height=ug(jm,"height",zg);this.b=ug(jm,"mimeType",bh);this.i=ug(jm,"codecs",bh);this.c=lm&&"main"==lm.value;this.lang&&(this.lang=dc(this.lang));km=qg(this,jm,zf);this.u=lg(im.u,km);this.j=qg(this,jm,xf);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=im.c?ng(this,jm,im.c):og(this,jm,bg);this.g=im.f?ng(this,jm,im.f):og(this,jm,eg);this.h=im.g?ng(this,jm,im.g):og(this,jm,gg);this.a=qg(this,jm,wf);!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]));};uf.prototype.parse=function(im,jm){this.value=ug(jm,"value",bh);};vf.prototype.parse=function(im,jm){this.id=ug(jm,"id",bh);this.lang=ug(jm,"lang",bh);this.contentType=ug(jm,"contentType",bh);this.lang&&(this.lang=dc(this.lang));};wf.prototype.parse=function(im,jm){this.id=ug(jm,"id",bh);this.bandwidth=ug(jm,"bandwidth",zg);this.width=ug(jm,"width",zg,im.width);this.height=ug(jm,"height",zg,im.height);this.f=ug(jm,"mimeType",bh,im.b);this.h=ug(jm,"codecs",bh,im.i);this.fbQualityLabel=ug(jm,"FBQualityLabel",bh);this.fbQualityClass=ug(jm,"FBQualityClass",bh);this.lang=im.lang;var km=qg(this,jm,zf);this.u=lg(im.u,km);this.c=qg(this,jm,xf);this.g=im.f?ng(this,jm,im.f):og(this,jm,bg);this.b=im.g?ng(this,jm,im.g):og(this,jm,eg);this.a=im.h?ng(this,jm,im.h):og(this,jm,gg);this.c=this.c.concat(im.j);};xf.prototype.parse=function(im,jm){this.f=jm;this.c=ug(jm,"schemeIdUri",bh);var km=ug(jm,"cenc:default_KID",bh);km&&(this.b=km.replace(/[-]/g,""));this.a=og(this,jm,yf);};yf.prototype.parse=function(im,jm){var km=rg(jm);if(km){this.psshBox=ud(km);try{this.parsedPssh=new ne(this.psshBox);}catch(lm){if(!(lm instanceof RangeError))throw lm;}}};zf.prototype.parse=function(im,jm){this.url=rg(jm);};ag.prototype.parse=function(im,jm){this.url=rg(jm);};bg.prototype.parse=function(im,jm){this.u=im.u||this.u;this.h=ug(jm,"timescale",zg,this.h);this.g=ug(jm,"presentationTimeOffset",ah,this.g);this.a=ug(jm,"indexRange",xg,this.a);this.f=ug(jm,"FBFirstSegmentRange",xg,this.f);this.b=og(this,jm,cg)||this.b;this.c=og(this,jm,dg)||this.c;};cg.prototype.parse=function(im,jm){var km=ug(jm,"sourceURL",bh);this.url=mg(im.u,km);this.a=ug(jm,"range",xg,tg(im.a));};dg.prototype.parse=function(im,jm){var km=ug(jm,"sourceURL",bh);this.url=mg(im.u,km);this.a=ug(jm,"range",xg);};eg.prototype.parse=function(im,jm){this.u=im.u||this.u;this.a=ug(jm,"timescale",zg,this.a);this.g=ug(jm,"presentationTimeOffset",ah,this.g);this.c=ug(jm,"duration",zg,this.c);var km=ug(jm,"startNumber",zg);null!=km&&(this.i=km);this.h=og(this,jm,dg)||this.h;this.b=(km=qg(this,jm,fg))&&0<km.length?km:this.b;this.f=og(this,jm,hg)||this.f;};fg.prototype.parse=function(im,jm){var km=ug(jm,"media",bh);this.b=mg(im.u,km);this.a=ug(jm,"mediaRange",xg);};gg.prototype.parse=function(im,jm){this.a=ug(jm,"timescale",zg,this.a);this.i=ug(jm,"presentationTimeOffset",ah,this.i);this.b=ug(jm,"duration",zg,this.b);var km=ug(jm,"startNumber",ah);null!=km&&(this.j=km);this.h=ug(jm,"media",bh,this.h);this.f=ug(jm,"index",bh,this.f);this.g=ug(jm,"initialization",bh,this.g);this.c=og(this,jm,hg)||this.c;};hg.prototype.parse=function(im,jm){this.a=qg(this,jm,ig);};ig.prototype.parse=function(im,jm){this.startTime=ug(jm,"t",ah);this.a=ug(jm,"d",ah);this.b=ug(jm,"r",yg);};function lg(im,jm){if(!jm||0===jm.length)return im;for(var km=[],lm=0;lm<jm.length;lm++){var mm=jm[lm].url;null==im||0===im.length?km.push(new bf(mm)):(mm=mg(im.slice(0,1),mm),km.push(mm[0]));}return km;}function mg(im,jm){if(!jm)return im;var km=new bf(jm);return im?im.map(function(lm){return lm.resolve(km);}):[km];}function ng(im,jm,km){var lm=tg(km);(jm=pg(jm,km.constructor.TAG_NAME))&&lm.parse(im,jm);return lm;}function og(im,jm,km){var lm=null;if(jm=pg(jm,km.TAG_NAME))lm=new km(),lm.parse(im,jm);return lm;}function pg(im,jm){for(var km=null,lm=0;lm<im.childNodes.length;lm++)if(im.childNodes[lm].tagName==jm){if(km)return null;km=im.childNodes[lm];}return km;}function qg(im,jm,km){for(var lm=[],mm=0;mm<jm.childNodes.length;mm++)if(jm.childNodes[mm].tagName==km.TAG_NAME){var nm=new km();nm.parse.call(nm,im,jm.childNodes[mm]);lm.push(nm);}return lm;}function rg(im){im=im.firstChild;return im.nodeType!=Node.TEXT_NODE?null:im.nodeValue;}function sg(im){return im?im.map(function(jm){return jm.clone();}):null;}function tg(im){return im?im.clone():null;}function ug(im,jm,km,lm){im=km(im.getAttribute(jm));return null!=im?im:void 0!==lm?lm:null;}function vg(im){if(!im)return null;im=Date.parse(im);return isNaN(im)?null:Math.floor(im/1000);}function wg(im){if(!im)return null;var jm=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(im);if(!jm)return null;im=0;var km=ah(jm[1]);km&&(im+=31536000*km);(km=ah(jm[2]))&&(im+=2592000*km);(km=ah(jm[3]))&&(im+=86400*km);(km=ah(jm[4]))&&(im+=3600*km);(km=ah(jm[5]))&&(im+=60*km);jm=j.parseFloat(jm[6]);(jm=isNaN(jm)?null:jm)&&(im+=jm);return im;}function xg(im){var jm=/([0-9]+)-([0-9]+)/.exec(im);if(!jm)return null;im=ah(jm[1]);if(null==im)return null;jm=ah(jm[2]);return null==jm?null:new jg(im,jm);}function yg(im){im=j.parseInt(im,10);return isNaN(im)?null:im;}function zg(im){im=j.parseInt(im,10);return 0<im?im:null;}function ah(im){im=j.parseInt(im,10);return 0<=im?im:null;}function bh(im){return im;}function ch(im,jm){this.url=im;this.b=jm||new dh();this.g=this.j=this.h=0;this.a=null;this.c=new yc();this.f=null;}m("shaka.util.AjaxRequest",ch);function dh(){this.body=null;this.a=1;this.i=1000;this.c=0;this.method="GET";this.g="arraybuffer";this.b={};this.h=this.l=false;this.f=this.m=null;this.j=false;}var eh=true;function fh(im){gh(im);im.b.body=null;im.c.destroy();im.c=null;im.f=null;}function gh(im){im.a&&(im.a.onload=null,im.a.onreadystatechange=null,im.a.onerror=null,im.a.ontimeout=null);im.a=null;}var hh=/(.*)\.(xx|fna)\.fbcdn\.net/,ih=/livestream-lookaside\.facebook\.com$/;ch.prototype.i=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var im=this.url.split(":")[1].split(";").pop().split(","),jm=im.pop(),jm="base64"==im.pop()?j.atob(jm.replace(/-/g,"+").replace(/_/g,"/")):j.decodeURIComponent(jm);"arraybuffer"==this.b.g&&(jm=td(jm).buffer);im=JSON.parse(JSON.stringify(new XMLHttpRequest()));im.response=jm;im.responseText=jm.toString();jm=this.c;jm.resolve(im);fh(this);return jm;}if(0==this.url.lastIndexOf("idb:",0))return this.A();this.h++;this.j=Date.now();this.g||(this.g=this.b.i);this.a=new XMLHttpRequest();var km=this.url,im=new bf(km);eh&&(this.f&&!this.f.supportsCaching()||this.b.h)&&pf(im.a,"_",Date.now());km=hh.test(km);if(null!=this.b.f&&km){var lm=this.b.f,mm=im.a;pf(mm,"_nc_p_n",lm.f);null!=lm.c?pf(mm,"_nc_p_ts",lm.c):null!=lm.b&&pf(mm,"_nc_p_o",lm.b);null!=lm.a&&pf(mm,"_nc_p_rid",lm.a);}1==this.b.j&&km&&pf(im.a,"_nc_playing",1);km=im.toString();im=ih.test(im.N);this.a.open(this.b.method,km,true);this.a.responseType=this.b.g;this.a.timeout=this.b.c;this.a.withCredentials=this.b.l||im;this.a.onload=this.l.bind(this);this.a.onreadystatechange=this.m.bind(this);this.a.onerror=this.v.bind(this);this.a.ontimeout=this.s.bind(this);for(jm in this.b.b)this.a.setRequestHeader(jm,this.b.b[jm]);this.a.send(this.b.body);return this.c;};ch.prototype.send=ch.prototype.i;function jh(im,jm,km){jm=Error(jm);jm.type=km;jm.status=im.a.status;jm.url=im.url;jm.method=im.b.method;jm.body=im.b.body;jm.bc=im.a;return jm;}ch.prototype.l=function(im){this.f&&this.f.sample(Date.now()-this.j,im.loaded);im=[403];200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),fh(this)):this.h<this.b.a&&-1===im.indexOf(this.a.status)?kh(this):(im=jh(this,"HTTP error.","net"),this.c.reject(im),fh(this));};ch.prototype.m=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED&&(this.a.ja=Date.now()-this.j,this.b.h)){var im=Date.parse(this.a.getResponseHeader("Date"));im&&(gb=im-Date.now());}};ch.prototype.v=function(){var im=jh(this,"Network failure.","net");this.c.reject(im);fh(this);};ch.prototype.s=function(){if(this.h<this.b.a){kh(this);}else{var im=jh(this,"Request timed out.","net");this.c.reject(im);fh(this);}};function kh(im){gh(im);j.setTimeout(im.i.bind(im),im.g*(1+.5*(2*Math.random()-1)));im.g*=2;}function lh(im,jm,km,lm){this.b=jm;this.h=km||0;this.g=null!=lm?lm:null;this.c=this.a=null;this.j=im;this.i=null;}var mh;m("shaka.util.FailoverUri",lh);function nh(im,jm){return im&&0!==im.length?im.map(function(km){return km.resolve(jm);}):[jm];}lh.setPrefetchCacheValueGetter=function(im){mh=im;};function oh(im,jm,km){if(im.a)return im.a;im.a=ph(im,0,jm||new dh(),km);return im.a;}lh.prototype.f=function(){if(this.c){this.a=null;var im=this.c;if(im.a&&im.a.readyState!=XMLHttpRequest.DONE){im.a.abort();var jm=jh(im,"Request aborted.","aborted");im.c.reject(jm);fh(im);}this.i=this.c=null;}};function ph(im,jm,km,lm){var mm=im.b[jm].toString();if(im.h||im.g){var nm=im.b[jm].N;!nm.endsWith("fbcdn.net")||nm.startsWith("interncache")||nm.endsWith("ak.fbcdn.net")?km.b.Range="bytes="+(im.h+"-"+(null!=im.g?im.g:"")):mm+="&bytestart="+im.h+"&byteend="+im.g;}im.j&&(mm=im.j(mm,km.b)||mm);nm=null;mh&&(nm=mh(mm));nm||(im.c=new ch(mm,km),lm&&(im.c.f=lm),nm=im.c.i());mm=nm.then(ed(im,function(om){this.i=this.c=this.a=null;this.i=om.a?new bf(om.a):this.b[jm];om.response.ja=om.ja;return h.resolve(om.response);}));return mm=mm.catch(ed(im,function(om){if(this.a&&jm+1<this.b.length)return this.a=ph(this,jm+1,km,lm);this.a=this.c=null;return h.reject(om);}));}lh.prototype.clone=function(){return new lh(this.j,this.b.map(function(im){return im.clone();}),this.h,this.g);};lh.prototype.toString=function(){return this.b[0].toString();};function qh(im,jm,km){this.a=new dh();this.a.g="text";this.a.a=3;this.a.c=1000*(null!=jm?jm:0);km&&(this.a.f=km);this.a.h=true;this.b=im;}function rh(im){var jm=im.b;return oh(jm,im.a).then(function(km){km instanceof ArrayBuffer&&(km=String.fromCharCode.apply(null,new Uint8Array(km)));if(km=qf(km,jm.b,[jm.i]))return h.resolve(km);km=Error("MPD parse failure.");km.type="dash";return h.reject(km);});}function sh(im){this.f=im;this.a=this.b=this.c=null;}function th(im,jm,km,lm){for(var mm=jm.a,nm=[],om=0;om<lm;++om){var pm=om+km,qm=(pm-1)*mm.b,rm=qm/mm.a,sm=(qm+mm.b)/mm.a,pm=uh(im,jm,mm.j+pm-1,qm);if(!pm)return null;nm.push(new yh(rm,sm,pm,qm));}return nm;}function uh(im,jm,km,lm){if(!jm.a)return null;var mm=jm.a.h;if(!mm)return jm.u?new lh(im,jm.u,0,null):null;km=vh(mm,jm.id,km,jm.bandwidth,lm);if(!km)return null;jm=nh(jm.u,km);return new lh(im,jm,0,null);}function vh(im,jm,km,lm,mm){var nm={RepresentationID:jm,Number:km,Bandwidth:lm,Time:mm};im=im.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(pm,qm,rm){if("$$"==pm)return "$";var sm=nm[qm];if(null==sm)return pm;"RepresentationID"==qm&&rm&&(rm=void 0);pm=sm.toString();rm=j.parseInt(rm,10)||1;rm=Math.max(0,rm-pm.length);return Array(rm+1).join("0")+pm;});try{return new bf(im);}catch(om){if(om instanceof URIError)return null;throw om;}}function wh(im,jm,km){var lm=0;jm*=km;im=im.a;km=[];for(var mm=0;mm<im.length&&im[mm].a;++mm){var nm=im[mm].startTime,nm=null!=nm?nm:lm,om=im[mm].b||0;0>om&&(om=im[mm].a,om=mm+1===im.length?Math.ceil((im[0].startTime+jm-nm)/om)-1:Math.ceil((im[mm+1].startTime-nm)/om)-1);0<km.length&&nm!=lm&&(km[km.length-1].end=nm);for(var pm=0;pm<=om;++pm)lm=nm+im[mm].a,km.push({start:nm,end:lm}),nm=lm;}return km;}function xh(im,jm){this.a=im;this.b=jm||null;}xh.prototype.destroy=function(){this.a&&(this.a.f(),this.a=null);this.b=null;};xh.prototype.create=function(){return this.a?oh(this.a):h.resolve(this.b);};function yh(im,jm,km,lm){this.startTime=im;this.endTime=jm;this.url=km;this.a=null!=lm?lm:null;}function zh(im,jm,km){return new yh(jm,km,im.url,null!=im.a?im.a:void 0);}function ai(im,jm){for(var km=im.length-1;0<=km;--km){var lm=im[km];if(jm>=lm.startTime&&(null==lm.endTime||jm<lm.endTime))return km;}return -1;}function bi(im,jm){return im.map(function(km){return zh(km,km.startTime+jm,null!=km.endTime?km.endTime+jm:null);});}function ci(){}ci.prototype.parse=function(im,jm,km,lm,mm){var nm=null;try{im:{var pm=[],qm=new hb(im),rm=lb(qm);if(1936286840!=lb(qm)){nm=null;}else{1==rm&&(rm=mb(qm));var sm=kb(qm);ob(qm,3);ob(qm,4);var tm=lb(qm);if(0==tm){nm=null;}else{var um,vm;0==sm?(um=lb(qm),vm=lb(qm)):(um=mb(qm),vm=mb(qm));ob(qm,2);var wm=qm.b.getUint16(qm.a,qm.c);qm.a+=2;im=um;jm=jm+rm+vm;for(vm=rm=0;vm<wm;vm++){var xm=lb(qm);um=(xm&2147483648)>>>31;var sm=xm&2147483647,ym=lb(qm);lb(qm);if(1==um){nm=null;break im;}var zm;zm=0==vm&&mm?mm:new lh(lm,km,jm,jm+sm-1);um=im/tm;var an=(im+ym)/tm;0===vm&&(rm=um);pm.push(new yh(um-rm,an-rm,zm));im+=ym;jm+=sm;}nm=pm;}}};}catch(om){if(!(om instanceof RangeError))throw om;}return nm;};function di(im){this.a=im;this.Z=0;this.g=[];this.Sa=false;}di.prototype.H=function(){return !!this.g[this.g.length-1];};di.prototype.lastPollHadChanges=di.prototype.H;di.prototype.F=function(){var im=this.g,jm=im.lastIndexOf(true);if(1>jm)return 0;im=im.lastIndexOf(true,jm-1);return 0>im?0:jm-im-1;};di.prototype.getFetchesBetweenRecentChanges=di.prototype.F;di.prototype.C=function(){return Math.floor((this.g.length-1-this.g.lastIndexOf(true))/2);};di.prototype.getConsecutiveUpdatesWithoutChanges=di.prototype.C;di.prototype.B=function(){return this.g.length-1-this.g.lastIndexOf(false);};di.prototype.getConsecutiveUpdatesWithChanges=di.prototype.B;di.prototype.destroy=function(){this.a=null;};di.prototype.length=function(){return this.a.length;};di.prototype.G=function(){return (this.a||[]).slice();};di.prototype.getSegments=di.prototype.G;function ei(im){if(0==im.a.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return im.a[0];}di.prototype.w=function(){if(0==this.a.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return this.a[this.a.length-1];};di.prototype.last=di.prototype.w;k=di.prototype;k.get=function(im){if(0>im||im>=this.a.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.a[im];};k.ma=function(im){im=ai(this.a,im);return 0<=im?this.a[im]:null;};k.Ma=function(im){fi(this,im);return true;};function fi(im,jm){im.Z!=jm.Z&&(jm=new di(bi(jm.a,im.Z-jm.Z)));if(0==im.length()){im.a=jm.a.slice(0);}else if(0!=jm.length()&&null!=im.w().endTime)if(null!=jm.w().endTime&&jm.w().endTime<im.w().endTime){im.Sa=true;}else{im.Sa=false;if(im.w().endTime<=ei(jm).startTime){var km=zh(im.w(),im.w().startTime,ei(jm).startTime),km=im.a.slice(0,-1).concat([km]);}else{var lm;for(lm=0;lm<im.a.length&&!(im.a[lm].endTime>=ei(jm).startTime);++lm);im.a[lm].startTime<ei(jm).startTime?(km=zh(im.a[lm],im.a[lm].startTime,ei(jm).startTime),km=im.a.slice(0,lm).concat([km])):(ei(im).startTime>ei(jm).startTime||ei(jm),km=im.a.slice(0,lm));}im.a=km.concat(jm.a);}}k.la=function(im){var jm=im-this.Z;if(0==jm)return 0;this.a=bi(this.a,jm);this.Z=im;return jm;};k.Ia=function(){return 0<this.length()?{start:ei(this).startTime,end:this.w().endTime}:{start:0,end:0};};function gi(im,jm,km,lm){di.call(this,im);this.i=jm;this.A=km;this.h=lm;this.j=this.i.b||this.i.a.reduce(function(mm,nm){return null==nm.a?NaN:mm+nm.a;},0)||0;this.b=this.s=this.f=null;hi(this);}n(gi,di);gi.prototype.destroy=function(){this.A=this.i=null;di.prototype.destroy.call(this);};gi.prototype.ma=function(im){ji(this,fb()/1000);return di.prototype.ma.call(this,im);};gi.prototype.Ma=function(im){if(!(im instanceof gi))return false;fi(this,im);this.j=Math.max(this.j,im.j);null==this.f?(this.h=im.h,hi(this)):ki(this);return true;};function hi(im){ki(im);if(0!=im.length()){im.length();var jm=null!=im.w().endTime?im.w().endTime:im.w().startTime;if(im.i.c>im.h){im.f=jm;}else{var km=im.h-(im.i.c+im.A.start);0>km?im.f=jm:km<Math.max(im.w().startTime,im.w().endTime||0)?(im.w(),im.f=jm):im.f=km;}im.s=im.w().startTime;im.b=ei(im).startTime;}}gi.prototype.la=function(im){im=di.prototype.la.call(this,im);Math.min.apply(null,this.a.filter(function(jm){return null!=jm.endTime;}).map(function(jm){return jm.endTime-jm.startTime;}));null!=this.f&&(this.s+=im,this.b+=im,this.f+=im);return im;};gi.prototype.Ia=function(){return ii(this,fb()/1000);};function ii(im,jm){ji(im,jm);if(null==im.f||null==im.s||null==im.b)return {start:0,end:0};var km=Number.POSITIVE_INFINITY;im.j&&(km=im.j);var lm=jm-im.h,mm=im.f+lm;null!=im.i.f&&(mm=mm-im.b-im.i.f,0<mm&&(im.b+=mm));im.b=Math.min(im.b,km);lm=im.s+lm;if(lm<im.b)return {start:im.b,end:im.b};lm=0<im.length()?null!=im.w().endTime?Math.min(lm,im.w().endTime):lm:im.b;lm=Math.max(lm,im.b);lm=Math.min(lm,km);return {start:im.b,end:lm};}function ji(im,jm){ki(im);if(null!=im.i.f)if(null==im.f){im.length();}else{for(var km=im.f+(jm-im.h),lm=0,mm=0;mm<im.a.length;++mm){var nm=null;mm<im.a.length-1?nm=im.a[mm+1].endTime:(nm=im.a[mm],nm=null!=nm.endTime?nm.endTime+(nm.endTime-nm.startTime):null);if(null!=nm&&nm<km-im.i.f){++lm;}else break;}0<lm&&im.a.splice(0,lm);}}function ki(im){if(im.j){for(var jm=0,km=im.a.length-1;0<=km;--km)if(im.a[km].startTime>im.j){++jm;}else break;0<jm&&im.a.splice(-jm);}}function li(im,jm,km,lm,mm){var nm=1,om=0,pm;if(im.c>lm){pm=null;}else{var qm=im.i||0,rm=im.f||0;pm=km.a;pm=pm.b/pm.a;var sm=lm-(im.c+jm.start);0>sm?pm=null:(rm=sm-2*pm-rm,0>rm&&(rm=0),rm=Math.ceil(rm/pm)*pm,sm-=pm,0>sm?pm=null:(qm=Math.floor(sm/pm)*pm-qm,0>qm&&(qm=0),qm=Math.floor(qm/pm)*pm,pm={ab:rm/pm+1,current:(qm>=rm?qm:rm)/pm+1}));}pm&&(nm=pm.ab,om=pm.current-pm.ab+1);nm=th(mm,km,nm,om);if(null==nm)throw im=Error("Failed to generate SegmentReferences."),im.type="stream",im;gi.call(this,nm,im,jm,lm);this.v=km;this.m=this.c=0<this.length()?im.c+jm.start+this.w().endTime:null;this.l=pm?pm.current+1:null;this.S=mm;}n(li,gi);li.prototype.destroy=function(){this.S=this.v=null;gi.prototype.destroy.call(this);};li.prototype.ma=function(im){var jm=fb()/1000;mi(this,jm);ji(this,jm);return di.prototype.ma.call(this,im);};li.prototype.Ma=function(im){if(null!=this.c||!(im instanceof li)||null==im.c)return false;this.c=im.c;this.m=im.m;this.l=im.l;this.h=im.h;this.j=im.j;fi(this,im);mi(this,fb()/1000);hi(this);return true;};li.prototype.la=function(im){im=gi.prototype.la.call(this,im);null!=this.c&&(this.c+=im,this.m+=im);return im;};li.prototype.Ia=function(){var im=fb()/1000;mi(this,im);return ii(this,im);};function mi(im,jm){if(null!=im.c&&null!=im.m&&null!=im.l){var km=im.v.a,km=km.b/km.a,lm=Math.floor((im.m+(jm-im.h)-im.c)/km);if(0!=lm){var mm=th(im.S,im.v,im.l,lm);Array.prototype.push.apply(im.a,bi(mm,im.Z));im.c+=lm*km;im.l+=lm;}}}function ni(im,jm,km,lm,mm){this.f=im;this.b=jm;this.c=km;this.h=lm;this.a=null;this.g=mm;}ni.prototype.destroy=function(){this.g=this.c=this.b=this.f=null;this.a&&(this.a.destroy(),this.a=null);};ni.prototype.create=function(){if(this.a)return h.resolve(this.a);if("dynamic"==this.f.type){try{this.a=new li(this.f,this.b,this.c,this.h,this.g);}catch(im){return h.reject(im);}}else{var jm;jm=this.c.a;if(jm=th(this.g,this.c,1,Math.ceil(this.b.a/(jm.b/jm.a)))){if(0<jm.length){var km=jm[jm.length-1];jm[jm.length-1]=zh(km,km.startTime,this.b.a);}jm=new di(jm);}else jm=null;this.a=jm;if(!this.a)return jm=Error("Failed to generate SegmentReferences"),jm.type="stream",h.reject(jm);}return h.resolve(this.a);};function oi(im,jm,km,lm,mm){this.c=im;this.b=jm;this.g=km;this.a=null;this.h=lm;this.f=mm;}oi.prototype.destroy=function(){this.f=this.g=this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);};oi.prototype.create=function(){if(this.a)return h.resolve(this.a);var im=this.g.b,jm=[];im.f&&(jm=wh(im.f,im.a||1,this.b.a||0));var km=0;im.c&&im.i?km=(im.i-1)*im.c:0<jm.length&&(km=jm[0].start-(im.g||0));var lm=km,mm=im.b.length;0<jm.length&&jm.length!=im.b.length&&(mm=Math.min(jm.length,im.b.length));for(var nm=[],om=0;om<mm;++om){var pm=im.b[om],qm=km/im.a,rm=null,sm=null;im.c?(rm=km+im.c,sm=rm/im.a):0<jm.length?(rm=jm[om].end-(im.g||0),sm=rm/im.a):(sm=qm+this.b.a,rm=sm*im.a);var km=rm,rm=0,tm=null;pm.a&&(rm=pm.a.ha,tm=pm.a.end);sm=Math.min(this.b.a+lm/im.a,sm);nm.push(new yh(qm,sm,new lh(this.f,pm.b,rm,tm)));}"dynamic"==this.c.type?this.a=new gi(nm,this.c,this.b,this.h):this.a=new di(nm);return h.resolve(this.a);};function pi(im,jm,km,lm,mm){this.b=im;this.c=jm;this.f=km;this.h=lm;this.a=null;this.g=mm;}pi.prototype.destroy=function(){this.g=this.f=this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null);};pi.prototype.create=function(){if(this.a)return h.resolve(this.a);for(var im=this.f.a,jm=wh(im.c,im.a||1,this.c.a||0),km=[],lm=0;lm<jm.length;++lm){var mm=jm[lm].start,nm=mm/im.a,om=jm[lm].end/im.a,pm=uh(this.g,this.f,lm+im.j,mm);if(!pm)return im=Error("Failed to generate media URL."),im.type="dash",h.reject(im);var qm=(im.i||0)/im.a;km.push(new yh(nm-qm,om-qm,pm,mm));}"dynamic"==this.b.type?this.a=new gi(km,this.b,this.c,this.h):this.a=new di(km);return h.resolve(this.a);};function qi(){this.D=ri++;this.id=this.L=this.K=null;this.b=0;this.height=this.width=this.bandwidth=null;this.c=this.a="";this.switchReason=this.fbQualityClass=this.fbQualityLabel=null;this.f=[];this.P=false;this.J=true;}var ri=0;qi.prototype.destroy=function(){this.K&&(this.K.destroy(),this.K=null);this.L&&(this.L.destroy(),this.L=null);};function si(im){var jm=im.a||"";im.c&&(jm+='; codecs="'+im.c+'"');return jm;}function ti(){this.D=ui++;this.id=null;this.contentType=this.lang="";this.b=false;this.o=[];this.a=[];}var ui=0;ti.prototype.destroy=function(){for(var im=0;im<this.o.length;++im)this.o[im].destroy();this.a=this.o=null;};function vi(im){for(var jm=[],km=0;km<im.a.length;++km){var lm=new yi();lm.id=im.D;lm.a=im.a[km];lm.contentType=im.contentType;lm.b=im.o.length?si(im.o[0]):"";jm.push(lm);}return jm;}function wi(){this.id=null;this.start=0;this.b=null;this.a=[];}wi.prototype.destroy=function(){for(var im=0;im<this.a.length;++im)this.a[im].destroy();this.a=null;};function xi(){this.b=false;this.h=this.g=this.f=null;this.c=0;this.a=[];this.i=false;}xi.prototype.destroy=function(){for(var im=0;im<this.a.length;++im)this.a[im].destroy();this.a=null;};function yi(){this.id=0;this.a=null;this.b=this.contentType="";}function zi(im,jm,km,lm,mm,nm){tc.call(this,im);this.b=jm;this.a=new fd(km,lm,mm,this);this.U=0;this.G=this.v=this.c=null;this.M=false;this.g=this.A=null;this.m=false;this.C=0;this.F=false;this.j=null;this.i=false;this.h=new yc();this.l=this.f=false;this.s=0;this.B=15;this.W=this.O=false;this.V=nm;this.H=this.T=false;}n(zi,tc);zi.prototype.I=function(im){null!=im.initialStreamBufferSize&&(this.s=Number(im.initialStreamBufferSize));null!=im.dynamicStreamBufferSize_&&(this.C=Number(im.dynamicStreamBufferSize_));null!=im.streamBufferSize&&(this.B=Number(im.streamBufferSize));null!=im.addCdnDebugQueryParameters&&(this.O=Boolean(im.addCdnDebugQueryParameters));null!=im.useInitialBufferSizeWhenPaused&&(this.W=Boolean(im.useInitialBufferSizeWhenPaused));null!=im.segmentRequestTimeout&&(this.a.s=Number(im.segmentRequestTimeout));null!=im.resolveVideoTimeUpdateOnFragmentedTimeRanges&&(this.T=Boolean(im.resolveVideoTimeUpdateOnFragmentedTimeRanges));null!=im.skipCallingSourceBufferAbort&&(this.a.A=Boolean(im.skipCallingSourceBufferAbort));};zi.prototype.destroy=function(){hj(this);this.h.destroy();this.c=this.h=null;this.a.destroy();this.S=this.b=this.a=null;};k=zi.prototype;k.ta=function(){return this.c;};k.Ja=function(){return this.v;};k.vb=function(im){this.f||im.then(function(){this.f=true;this.g||gj(this,0);}.bind(this)).catch(function(){});return this.h;};k.La=function(){return this.l;};k.ua=function(im,jm,km,lm){im!=this.c&&(this.G=im.L.create(),im.K.create().then(ed(this,function(mm){if(this.b){var nm=this.c;this.c=im;this.v=mm;this.M=true;this.A=lm?lm:null;this.m||(nm?jm&&aj(this,true,km):gj(this,0));}})).catch(ed(this,function(mm){"aborted"!=mm.type&&(this.f?(mm=zb(mm),this.dispatchEvent(mm)):this.h.reject(mm));})));};k.rb=function(){return aj(this,false);};k.sb=function(){this.F=true;};function aj(im,jm,km){im.c&&!im.m&&(im.m=true,hj(im),md(im.a).then(ed(im,function(){var lm=this.b.currentTime;if(!jm&&0<hd(this.a,lm)&&0<=ai(this.a.b,lm))return h.resolve();if(km)return ld(this.a,this.b.currentTime+km);this.H=true;return kd(this.a);})).then(ed(im,function(){this.m=false;gj(this,0);})).catch(ed(im,function(lm){this.m=false;this.f?(lm=zb(lm),this.dispatchEvent(lm)):this.h.reject(lm);})));}k.tb=function(im){return 0<hd(this.a,im)&&0<=ai(this.a.b,im);};k.xa=function(){};k.Ga=function(){return true;};function bj(im){var jm=im.W&&im.b.paused?im.s:im.B;im.C&&!im.b.paused&&(jm=Math.max(Math.min(im.v.w().endTime-im.b.currentTime,im.C),im.B));return im.i?Math.max(im.s,jm):im.s;}k.Lb=function(){if(this.i&&!this.f){this.g=null;}else{var im;if(im=this.f&&!this.l)im=1<this.a.f.buffered.length?true:false;if(im&&(this.F||od(this.b))){this.T&&(this.b.currentTime=nd(this.b)),this.F=false,aj(this,true);}else{this.g=null;im=this.c;var jm=this.v,km=this.b.currentTime;if(hd(this.a,this.i?km:km+(this.j||0))>=bj(this)){dj(this),gj(this,1000/(5*(Math.abs(this.b.playbackRate)||1)));}else{var lm=cj(this,km,jm);lm?(jm=jd(this.a,lm,im.b,this.G,this.O&&!this.b.paused),this.V&&"video"===im.a.split("/")[0]&&this.V(lm.startTime,lm.endTime,{id:im.id,reason:this.A}),this.G=null,this.M&&(this.M=false,lm=this.A,this.A=null,ej(this,im,lm)),this.l=false,jm.then(ed(this,function(mm){var nm=mm.Z;mm=mm.wb;this.i||(this.U=mm);null==this.j&&(this.j=nm);this.H&&0<hd(this.a,km)&&(this.H=false,this.b.currentTime+=.001);gj(this,0);})).catch(ed(this,function(mm){if("aborted"!=mm.type){var nm=[0,404,410,502,503,504];"net"==mm.type&&-1!=nm.indexOf(mm.bc.status)&&this.c&&gj(this,1000);mm=zb(mm);this.dispatchEvent(mm);}}))):(dj(this),this.f&&!this.l&&(this.l=true,fj(this)),gj(this,200));}}}};function cj(im,jm,km){im=im.a;var lm=im.b.length;im=0<lm?im.b[lm-1]:null;return null!=im?null!=im.endTime?km.ma(im.endTime):null:km.ma(jm)||(km.length()?km.w():null);}function dj(im){if(!im.i&&null!=im.j){im.i=true;var jm=im.a,km=im.j,lm=km-jm.v;0!=lm&&(jm.b=bi(jm.b,lm),jm.v=km);im.h.resolve(im.j);}}function ej(im,jm,km){var lm=jm.a.split("/")[0];jm=yb({type:"adaptation",bubbles:true,contentType:lm,size:"video"!=lm?null:{width:jm.width,height:jm.height},bandwidth:jm.bandwidth,reason:km});im.dispatchEvent(jm);}function fj(im){var jm=yb({type:"ended"});im.dispatchEvent(jm);}function gj(im,jm){im.g=j.setTimeout(im.Lb.bind(im),jm);}function hj(im){null!=im.g&&(j.clearTimeout(im.g),im.g=null);}k.Ha=function(){return this.U;};function ij(im){this.b=im;this.a=null;}ij.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null);};ij.prototype.create=function(){if(this.a)return h.resolve(this.a);var im=new yh(0,null,this.b);this.a=new di([im]);return h.resolve(this.a);};function jj(im,jm){tc.call(this,im);this.b=jm;this.g=true;this.h=this.f=null;this.c=new yc();this.a=null;}n(jj,tc);jj.prototype.I=function(){};jj.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.c.destroy();this.S=this.b=this.f=this.h=this.a=this.c=null;};k=jj.prototype;k.ta=function(){return this.f;};k.Ja=function(){return this.h;};k.vb=function(){return this.c;};k.La=function(){return true;};k.ua=function(im){im.K.create().then(ed(this,function(jm){if(this.b){if(0==jm.length())return h.reject(Error("No subtitles URL available."));var km=this.f;this.f=im;this.h=jm;jm=ei(jm).url.b[0].toString();var lm=this.Ga();this.a&&(this.xa(false),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=jm;this.xa(lm);jm=yb({type:"adaptation",bubbles:true,contentType:"text",size:null,bandwidth:im.bandwidth});this.dispatchEvent(jm);km||this.c.resolve(0);}}));};k.rb=function(){};k.sb=function(){};k.tb=function(){return true;};k.xa=function(im){this.g=im;this.a&&(this.a.track.mode=im?"showing":"disabled");};k.Ga=function(){this.a&&(this.g="showing"==this.a.track.mode);return this.g;};function kj(){}kj.prototype.parse=function(im,jm,km,lm){var mm=null;try{var om,pm=new pb(jm);if(440786851!=rb(pm).id){om=null;}else{var qm=rb(pm);if(408125543!=qm.id){om=null;}else{var rm=qm.a.byteOffset,sm,tm=new pb(qm.a);for(jm=null;jb(tm.a);){var um=rb(tm);if(357149030==um.id){jm=um;break;}}if(jm){for(var vm=new pb(jm.a),tm=1e+06;jb(vm.a);){var wm=rb(vm);if(2807729==wm.id){tm=ub(wm);break;}}sm=tm/1e+09;}else sm=null;om=sm?{Vb:rm,$b:sm}:null;}}if(om){var xm=rb(new pb(im));if(475249515!=xm.id){mm=null;}else{var ym=om.Vb,zm=om.$b;im=[];var an=new pb(xm.a);for(om=xm=-1;jb(an.a);){var bn=rb(an);if(187==bn.id){var cn,dn=new pb(bn.a),en=rb(dn);if(179!=en.id){cn=null;}else{var fn=ub(en),gn=rb(dn);if(183!=gn.id){cn=null;}else{for(var hn=new pb(gn.a),rm=0;jb(hn.a);){var jn=rb(hn);if(241==jn.id){rm=ub(jn);break;}}cn={ac:fn,Tb:rm};}}if(cn){var kn=zm*cn.ac,ln=ym+cn.Tb;if(0<=xm){var mn=new lh(lm,km,om,ln-1);im.push(new yh(xm,kn,mn));}xm=kn;om=ln;}}}0<=xm&&(mn=new lh(lm,km,om,null),im.push(new yh(xm,null,mn)));mm=im;}}else mm=null;}catch(nm){if(!(nm instanceof RangeError))throw nm;}return mm;};function lj(im,jm,km,lm,mm,nm,om,pm){this.g=im;this.i=jm;this.c=km;this.a=lm;this.f=mm;this.b=nm;this.j=om;this.ka=null;this.h=pm;}lj.prototype.destroy=function(){this.h=this.i=this.g=null;this.a.f();this.a=null;this.b&&(this.b.f(),this.b=null);this.f&&(this.f.f(),this.f=null);this.ka=null;};lj.prototype.create=function(){if("webm"==this.c){var im=Error("WebM is not supported in this build configuration.");im.type="app";return h.reject(im);}if(this.ka)return this.ka;im=[oh(this.a)];"webm"==this.c&&im.push(oh(this.f));this.b&&oh(this.b);return this.ka=h.all(im).then(ed(this,function(jm){var km=jm[0];jm=jm[1]||null;var lm=null;"mp4"==this.c?(lm=new ci(),lm=lm.parse(new DataView(km),this.a.h,this.a.b,this.h,this.b)):"webm"==this.c&&(lm=new kj(),lm=lm.parse(new DataView(km),new DataView(jm),this.a.b,this.h));if(!lm)return km=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),km.type="stream",h.reject(km);var mm;"dynamic"==this.g.type?mm=new gi(lm,this.g,this.i,this.j):mm=new di(lm);return h.resolve(mm);}));};function mj(im){this.a=im;}function nj(im,jm,km){for(var lm=fb()/1000,mm=0;mm<jm.a.length;++mm)for(var nm=jm.a[mm],om=0;om<nm.b.length;++om){var pm=nm.b[om];if("text"!=pm.contentType)for(var qm=0;qm<pm.a.length;++qm){var rm=pm.a[qm],sm=0,sm=sm+(rm.g?1:0),sm=sm+(rm.b?1:0),sm=sm+(rm.a?1:0);0==sm?(pm.a.splice(qm,1),--qm):1!=sm&&(rm.g?(rm.b=null,rm.a=null):rm.b&&(rm.a=null));}}oj(jm);for(mm=0;mm<jm.a.length;++mm)for(nm=jm.a[mm],om=0;om<nm.b.length;++om){qm=pm=nm.b[om];rm=null;for(sm=0;sm<qm.a.length;++sm){var tm=qm.a[sm].f||"";rm?tm!=rm&&(qm.a.splice(sm,1),--sm):rm=tm;}0==pm.a.length&&(nm.b.splice(om,1),--om);}"dynamic"==jm.type&&null==jm.c&&(jm.c=lm);mm=new xi();"dynamic"==jm.type&&(mm.b=true,mm.f=jm.g,mm.g=new lh(km,jm.j||jm.url),mm.h=jm.c);mm.c=jm.h||5;for(nm=0;nm<jm.a.length;++nm){om=jm.a[nm];if(null==om.start)break;om=pj(im,jm,om,lm,km);mm.a.push(om);}return mm;}function oj(im){if(im.a.length){null==im.a[0].start&&(im.a[0].start=0);var jm=function(qm){return 0==qm||!!qm;};"dynamic"==im.type&&(im.b=null);jm(im.b)&&1==im.a.length&&!jm(im.a[0].a)&&(im.a[0].a=im.b);for(var km=0,lm=true,mm=0;mm<im.a.length;++mm){var nm=im.a[mm-1],om=im.a[mm],pm=im.a[mm+1]||{start:im.b};!jm(om.start)&&nm&&jm(nm.start)&&jm(nm.a)&&(om.start=nm.start+nm.a);!jm(om.a)&&jm(pm.start)&&(om.a=pm.start-om.start);null!=om.start&&null!=om.a?km+=om.a:lm=false;}jm(im.b)||(mm=im.a[im.a.length-1],lm?im.b=km:jm(mm.start)&&jm(mm.a)?im.b=mm.start+mm.a:"dynamic"!=im.type&&(im.b=km));}}function pj(im,jm,km,lm,mm){var nm=new wi();nm.id=km.id;nm.start=km.start;nm.b=km.a;var om=new lc();km.b.forEach(function(ym){om.push(ym.contentType||"",ym);});for(var pm=oc(om),qm=0;qm<pm.length;++qm){var rm=new lc();om.get(pm[qm]).forEach(function(ym){rm.push(ym.group,ym);});for(var sm=oc(rm),tm=0;tm<sm.length;++tm){var um=new lc();rm.get(sm[tm]).forEach(function(ym){um.push(ym.lang,ym);});for(var vm=oc(um),wm=0;wm<vm.length;++wm){var xm=um.get(vm[wm]),xm=qj(im,jm,km,xm,lm,mm);nm.a.push(xm);}}}return nm;}function qj(im,jm,km,lm,mm,nm){o(lm.every(function(wm){return wm.group==lm[0].group&&(wm.lang||"")==(lm[0].lang||"")&&(wm.contentType||"")==(lm[0].contentType||"");}));var om=new ti(),pm=lm.filter(function(wm){return null!=wm.id;});pm.length==lm.length&&(om.id=pm.map(function(wm){return wm.id;}).sort().reduce(function(wm,xm){return wm+","+xm;}));om.lang=lm[0].lang||"";om.contentType=lm[0].contentType||"";om.b=lm.some(function(wm){return wm.c;});for(var pm={},qm=0;qm<lm.length;++qm)for(var rm=lm[qm],sm=0;sm<rm.a.length;++sm){var tm=rm.a[sm],um=tj(im,tm),vm=om.a.slice(0);sj(um,vm);0==vm.length&&0<om.a.length||!(tm=vj(jm,km,tm,mm,nm))||(om.o.push(tm),om.a=vm,pm[tm.D]=rm);}if(om.a.some(function(wm){return ""==wm.a;}))return om.o.forEach(function(wm){wm.P=true;}),om;im=rj(lm);for(qm=0;qm<om.o.length;++qm)tm=om.o[qm],rm=pm[tm.D],rm==im&&(tm.P=true);return om;}function rj(im){for(var jm=null,km=null,lm=0;lm<im.length;++lm)for(var mm=im[lm],nm=0;nm<mm.a.length;++nm){var om=mm.a[nm],om=(om.width||1)*(om.height||1)*(om.bandwidth||1);if(null==jm||om<jm)jm=om,km=mm;}return km;}function sj(im,jm){if(0==jm.length){Array.prototype.push.apply(jm,im);}else for(var km=0;km<jm.length;++km){for(var lm=false,mm=0;mm<im.length;++mm){var nm=jm[km],om=im[mm];if(nm.a==om.a&&nm.h==om.h&&nm.l==om.l&&nm.g==om.g&&nm.i==om.i&&nm.f==om.f&&nm.j==om.j&&wd(nm.c,om.c)){lm=true;zd(jm[km],im[mm].b);break;}}lm||(jm.splice(km,1),--km);}}function tj(im,jm){var km=[];if(0==jm.c.length){km.push(new xd());}else if(im.a)for(var lm=0;lm<jm.c.length;++lm)km.push.apply(km,uj(im,jm.c[lm]));return km;}function uj(im,jm){var km=[];if(2!=im.a.length)return [];var lm=im.a(jm.c||"",jm.f);if(!(lm&&lm instanceof Array))return [];for(var mm=0;mm<lm.length;++mm){var nm,om=lm[mm];nm=new xd();if(om){var pm=ic(om,"keySystem");if(null!=pm){nm.a=pm;}else throw Error("'keySystem' cannot be null.");var qm=ic(om,"licenseServerUrl");if(null!=qm){nm.h=qm;}else if(pm)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");pm=gc(om,"withCredentials");null!=pm&&(nm.l=pm);pm=kc(om,"licensePostProcessor",Function);null!=pm&&(nm.m=pm);pm=kc(om,"licensePreProcessor",Function);null!=pm&&(nm.s=pm);pm=gc(om,"distinctiveIdentifierRequired");null!=pm&&(nm.g=pm);pm=gc(om,"persistentStateRequired");null!=pm&&(nm.i=pm);pm=ic(om,"audioRobustness");null!=pm&&(nm.f=pm);pm=ic(om,"videoRobustness");null!=pm&&(nm.j=pm);pm=kc(om,"serverCertificate",Uint8Array);null!=pm&&(nm.c=pm);if(pm=kc(om,"initData",Object)){om=kc(pm,"initData",Uint8Array);if(null==om)throw Error("'initData.initData' cannot be null.");pm=ic(pm,"initDataType");if(null==pm)throw Error("'initData.initDataType' cannot be null.");nm.b.push({initData:new Uint8Array(om.buffer),initDataType:pm});}}0==nm.b.length&&jm.a&&jm.a.psshBox&&zd(nm,[{initData:jm.a.psshBox,initDataType:"cenc"}]);km.push(nm);}return km;}function vj(im,jm,km,lm,mm){if(!km.u||0===km.u.length)return null;var nm=null,om=1,pm=0;if(km.g){nm=km.f.split("/")[1];if("mp4"!=nm&&"webm"!=nm){nm=null;}else{var qm=km.g;"webm"!=nm||qm.c?qm.a||qm.b&&qm.b.a?(om=qm.b,om||(om=new cg(),om.url=km.u,om.a=qm.a?qm.a.clone():null),pm=xj(om,mm),om=qm.c?xj(qm.c,mm):null,qm.f?(qm=qm.f,qm=new lh(mm,km.u,qm.ha,qm.end)):qm=null,im=new lj(im,jm,nm,pm,om,qm,lm,mm),jm=new xh(om),lm=new qi(),lm.K=im,lm.L=jm,nm=lm):nm=null:nm=null;}om=km.g.h;pm=km.g.g;}else if(km.b){nm=km.b,!nm.c&&!nm.f&&1<nm.b.length?nm=null:nm.c||jm.a||nm.f||1!=nm.b.length?nm.f&&0===nm.f.a.length?nm=null:(nm=nm.h?xj(nm.h,mm):null,im=new oi(im,jm,km,lm,mm),jm=new xh(nm),lm=new qi(),lm.K=im,lm.L=jm,nm=lm):nm=null,om=km.b.a,pm=km.b.g;}else if(km.a){im:if(nm=km.a,om=0+(nm.f?1:0),om+=nm.c?1:0,om+=nm.b?1:0,0==om?om=false:(1!=om&&(nm.f?(nm.c=null,nm.b=null):nm.c&&(nm.b=null)),om=true),om){om=null;if(nm.g&&(om=(nm=km.a.g)?wj(km,nm,dg):null,!om)){nm=null;break im;}nm=om?xj(om,mm):null;om=km.a;om.f?(om=km.f.split("/")[1],"mp4"!=om&&"webm"!=om?im=null:"webm"!=om||nm?uh(mm,km,1,0)?(pm=(pm=km.a.f)?wj(km,pm,cg):null)?(pm=xj(pm,mm),im=new lj(im,jm,om,pm,nm,null,lm,mm)):im=null:im=null:im=null):im=om.h?om.c?new pi(im,jm,km,lm,mm):om.b?"dynamic"!=im.type&&null==jm.a?null:new ni(im,jm,km,lm,mm):null:null;im?(jm=new xh(nm),lm=new qi(),lm.K=im,lm.L=jm,nm=lm):nm=null;}else nm=null;;om=km.a.a;pm=km.a.i;}else "text"==km.f.split("/")[0]&&(nm=new qi(),nm.K=new ij(new lh(mm,km.u)));if(!nm)return null;nm.id=km.id;pm&&(nm.b=-1*pm/om);nm.bandwidth=km.bandwidth;nm.width=km.width;nm.height=km.height;nm.a=km.f||"";nm.c=km.h||"";nm.fbQualityLabel=km.fbQualityLabel||null;nm.fbQualityClass=km.fbQualityClass||null;for(im=0;im<km.c.length;++im)jm=km.c[im],jm.b&&nm.f.push(jm.b);return nm;}function wj(im,jm,km){jm=vh(jm,im.id,null,im.bandwidth,null);if(!jm)return null;km=new km();km.url=nh(im.u,jm);return km;}function xj(im,jm){var km=im.url,lm=0,mm=null;im.a&&(lm=im.a.ha,mm=im.a.end);return new lh(jm,km,lm,mm);}function yj(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[];}function zj(im,jm){var km=new ak(jm);im.streamHistory.push(new bk(km));if(km.videoHeight||!im.streamStats)im.streamStats=km;}function ak(im){this.videoWidth=im.width;this.videoHeight=im.height;this.videoMimeType=im.a;this.videoBandwidth=im.bandwidth;}function bk(im){this.timestamp=fb()/1000;this.value=im;}function ck(im,jm,km,lm,mm){this.b=new lh(null,[new bf(im)]);this.a=new dh();this.a.body=jm;this.a.method=km;this.a.a=3;this.a.l=lm;this.a.c=0;im=mm||{};for(var nm in im)this.a.b[nm]=im[nm];}function dk(im){return oh(im.b,im.a).then(function(jm){return h.resolve(new Uint8Array(jm));});}function ek(im,jm,km){tc.call(this,im);this.c=jm;this.j=km;this.a=this.h=null;this.i=new pc();this.b=[];this.f=[];this.m=0;this.g=new yc();this.l=null;}n(ek,tc);ek.prototype.destroy=function(){this.S=null;for(var im=0;im<this.f.length;++im)this.f[im].close().catch(function(){});this.f=[];this.b=this.a=this.h=null;this.g.destroy();this.g=null;this.i.destroy();this.i=null;this.l&&(j.clearTimeout(this.l),this.l=null);this.c=this.j=null;};ek.prototype.initialize=function(){var im=new lc(),jm;jm=this.j;if(jm.C){jm=jm.a.a[0];for(var km=[],lm=0;lm<jm.a.length;++lm)km.push.apply(km,vi(jm.a[lm]));jm=km;}else jm=[];for(km=0;km<jm.length;++km)lm=jm[km],lm.a.a||lm.b&&!mk(lm.b)||im.push(lm.contentType,lm);for(var km={},lm=false,mm=0;mm<jm.length;++mm){var nm=jm[mm];if(nm.a.a&&!im.a.hasOwnProperty(nm.contentType)){var om=nm.a.a,pm=km[om];pm||(pm=nm.a,pm={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:pm.g?"required":"optional",persistentState:pm.i?"required":"optional",sessionTypes:["temporary"]},km[om]=pm);if(nm.b&&(om=nm.contentType+"Capabilities",om in pm)){lm=true;pm[om]||(pm[om]=[]);var qm;"audio"==nm.contentType?qm=nm.a.f:"video"==nm.contentType&&(qm=nm.a.j);pm[om].push({contentType:nm.b,robustness:qm});}}}if(!lm)if(jm.length){this.a=jm[0].a;}else throw im=Error("No DrmInfo exists!"),im.type="drm",im;if(0==Object.keys(km).length)return ll(this.j,im),this.g.resolve(),h.resolve();qm=new yc();km=fk(km,qm);km=km.then(this.v.bind(this,jm,im));qm.reject(null);return km;};function fk(im,jm){for(var km in im)jm=jm.catch(function(lm,mm){return navigator.requestMediaKeySystemAccess(lm,[mm]);}.bind(null,km,im[km]));return jm;}ek.prototype.v=function(im,jm,km){if(!this.c)return hk();for(var lm=km.keySystem,mm=km.getConfiguration(),nm=["audio","video"],om=0;om<nm.length;++om){var pm=nm[om];if(!jm.a.hasOwnProperty(pm)){var qm=mm[pm+"Capabilities"];if(qm){for(var qm=qm[0],rm=[],sm={},tm=0;tm<im.length;++tm){var um=im[tm],vm=qm?um.b==qm.contentType:um.contentType==pm;um.a.a!=lm||!vm||um.id in sm||(rm.push(um),sm[um.id]=true,this.a=this.a?yd(this.a,um.a):um.a);}jm.set(pm,rm);}}}ll(this.j,jm);return km.createMediaKeys().then(function(wm){this.h=wm;}.bind(this));};function gk(im){return im.c?im.h?im.c.setMediaKeys(im.h).then(ed(im,function(){return this.c?this.a.c?this.h.setServerCertificate(this.a.c):h.resolve():hk();})).then(ed(im,function(){if(!this.c)return hk();for(var jm=0;jm<this.a.b.length;++jm){var km=this.a.b[jm];this.s({type:"encrypted",initDataType:km.initDataType,initData:km.initData});}0==this.a.b.length&&qc(this.i,this.c,"encrypted",this.s.bind(this));})):h.resolve():hk();}function hk(){var im=Error("EmeManager destroyed");im.type="destroy";return h.reject(im);}ek.prototype.s=function(im){for(var jm=new Uint8Array(im.initData),km=0;km<this.b.length;++km)if(wd(jm,this.b[km].data))return;try{var mm=ik(this);}catch(lm){jm=zb(lm);this.dispatchEvent(jm);this.g.reject(lm);return;}im=mm.generateRequest(im.initDataType,im.initData);this.b.push({data:jm,Oa:mm});im.catch(ed(this,function(nm){if(this.c){for(var om=0;om<this.b.length;++om)if(this.b[om].Oa==mm){this.b.splice(om,1);break;}om=zb(nm);this.dispatchEvent(om);this.g.reject(nm);}}));this.f.push(mm);};function ik(im){var jm=null,jm=im.h.createSession();qc(im.i,jm,"message",im.B.bind(im));qc(im.i,jm,"keystatuseschange",im.A.bind(im));return jm;}ek.prototype.B=function(im){jk(this,im.target,this.a,im.message);};ek.prototype.A=function(im){im=im.target;var jm={};im.keyStatuses.forEach(function(lm,mm){if("string"==typeof lm){var nm=lm;lm=mm;mm=nm;}if("com.microsoft.playready"==this.a.a&&16==lm.byteLength){var nm=new DataView(lm),om=nm.getUint32(0,true),pm=nm.getUint16(4,true),qm=nm.getUint16(6,true);nm.setUint32(0,om,false);nm.setUint16(4,pm,false);nm.setUint16(6,qm,false);}nm=vd(new Uint8Array(lm));jm[nm]=mm;}.bind(this));if(im.expiration<Date.now()){for(var km=0;km<this.b.length;++km)if(this.b[km].Oa==im){this.b.splice(km,1);break;}im.close();this.f.splice(this.f.indexOf(im),1);}ol(this.j,jm);};function jk(im,jm,km,lm){lm=kk(km,lm);dk(new ck(lm.url,lm.body,lm.method,km.l,lm.headers)).then(ed(im,function(mm){km.m&&(mm=km.m(mm));return jm.update(mm);})).then(ed(im,function(){var mm=yb({type:"sessionReady",detail:jm});this.dispatchEvent(mm);this.m++;this.m>=this.f.length&&this.g.resolve();})).catch(ed(im,function(mm){mm.Oa=jm;mm=zb(mm);this.dispatchEvent(mm);}));}function kk(im,jm){var km={url:im.h,body:jm.slice(0),method:"POST",headers:{}};if("com.microsoft.playready"===im.a){for(var lm=String.fromCharCode.apply(null,new Uint16Array(km.body)),lm=(new DOMParser()).parseFromString(lm,"application/xml"),mm=lm.getElementsByTagName("name"),nm=lm.getElementsByTagName("value"),om=0;om<mm.length;om++)km.headers[mm[om].childNodes[0].nodeValue]=nm[om].childNodes[0].nodeValue;km.body=j.atob(lm.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue);}if(!im.s)return km;im.s(km);km.url=ic(km,"url");if(null==km.url)throw Error("'url' cannot be null.");if(!(km.body instanceof ArrayBuffer||"string"==typeof km.body||null==km.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");km.method=ic(km,"method");if("GET"!=km.method&&"POST"!=km.method)throw Error("'method' must be either 'GET' or 'POST'.");km.headers=kc(km,"headers",Object);if(null==km.headers)throw Error("'headers' cannot be null.");return km;}function lk(im){tc.call(this,null);this.a=im;this.b=null;this.f=new pc();this.i=this.h=null;this.B=0;this.v=null;this.j=false;this.H=true;this.F=false;this.G=true;this.g=new yj();this.c={enableAdaptation:true,streamBufferSize:15,liveStreamEndTimeout:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new w()};this.l=1;this.C=null;this.s=false;}n(lk,tc);m("shaka.player.Player",lk);lk.version="v1.6.4-fb";lk.isBrowserSupported=function(){return !!j.MediaSource&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement" in document&&!!j.Uint8Array;};lk.prototype.V=function(im){this.H=im;};lk.prototype.setResumeAfterBuffering=lk.prototype.V;function mk(im){return "text/vtt"==im?!!j.VTTCue:MediaSource.isTypeSupported(im);}lk.isTypeSupported=mk;lk.setTextStyle=function(im){var jm=document.getElementById("ShakaPlayerTextStyle");jm||(jm=document.createElement("style"),jm.id="ShakaPlayerTextStyle",document.head.appendChild(jm));for(jm=jm.sheet;jm.cssRules.length;)jm.deleteRule(0);jm.insertRule("::cue { "+y(im)+" }",0);};lk.prototype.destroy=function(){return this.m().then(ed(this,function(){this.f.destroy();this.a=this.f=null;})).catch(function(){});};lk.prototype.destroy=lk.prototype.destroy;lk.prototype.m=function(){if(!this.b)return h.resolve();this.j&&sk(this);this.a.pause();rc(this.f);rk(this);pk(this);this.h&&(this.h.destroy(),this.h=null);this.a.src="";var im=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.j=false;this.g=new yj();return im;};lk.prototype.unload=lk.prototype.m;lk.prototype.pa=function(im){return nk(this,im,false);};lk.prototype.load=lk.prototype.pa;lk.prototype.O=function(im){return nk(this,im,true);};lk.prototype.loadWithSilencedErrors=lk.prototype.O;function nk(im,jm,km){fl(jm,im.a);var lm=null;if(im.b||!im.F)lm=im.m().then(ed(im,function(){return jm.ya();}));im.a.autoplay&&(q("load"),qc(im.f,im.a,"timeupdate",im.Ab.bind(im)));jm.ib(im.c);jm.O=im.C;im.C=null;lm||(lm=jm.ya());lm.catch(ed(im,function(mm){jm.destroy();return h.reject(mm);}));return lm.then(ed(im,function(){if(!this.a)return ok();this.b=jm;qc(this.f,this.b,"seekrangechanged",this.Hb.bind(this));this.h=new ek(this,this.a,this.b);return this.h.initialize();})).then(ed(im,function(){if(!this.a)return ok();qc(this.f,this.a,"error",this.Xb.bind(this));qc(this.f,this.a,"playing",this.Gb.bind(this));qc(this.f,this.a,"pause",this.Fb.bind(this));return gl(this.b,this,this.a);})).then(ed(im,function(){return this.a?gk(this.h):ok();})).then(ed(im,function(){if(!this.a)return ok();qk(this);})).catch(ed(im,function(mm){if(!this.a)return ok();if(true!==km&&"destroy"!=mm.type){var nm=zb(mm);this.dispatchEvent(nm);}return this.m().then(function(){return h.reject(mm);});}));}function ok(){var im=Error("Player destroyed");im.type="destroy";return h.reject(im);}k=lk.prototype;k.Ab=function(){r("load");this.g.playbackLatency=s("load")/1000;this.f.va(this.a,"timeupdate");};k.Xb=function(){if(this.a.error){var im=this.a.error.code;im!=MediaError.MEDIA_ERR_ABORTED&&(im=Error(tk[im]||"Unknown playback error."),im.type="playback",im=zb(im),this.dispatchEvent(im));}};k.Gb=function(){q("playing");!this.i&&0>this.l&&(this.a.playbackRate=0,this.A(this.a.currentTime,Date.now(),this.l));this.j&&!this.G&&sk(this);};k.Fb=function(){r("playing");var im=s("playing");if(!isNaN(im)){var jm=this.g;jm.playTime+=im/1000;}pk(this);};k.Hb=function(im){this.B=im.start;};k.ub=function(){if(!this.a.paused){r("playing");var im=s("playing");if(!isNaN(im)){var jm=this.g;jm.playTime+=im/1000;q("playing");}}im=this.g;jm=this.a;jm.getVideoPlaybackQuality&&(jm=jm.getVideoPlaybackQuality(),im.decodedFrames=jm.totalVideoFrames,im.droppedFrames=jm.droppedVideoFrames);return this.g;};lk.prototype.getStats=lk.prototype.ub;lk.prototype.oa=function(){return this.b?this.b.G():[];};lk.prototype.getVideoTracks=lk.prototype.oa;lk.prototype.fa=function(){return this.b?this.b.W():[];};lk.prototype.getAudioTracks=lk.prototype.fa;lk.prototype.na=function(){return this.b?this.b.jb():[];};lk.prototype.getTextTracks=lk.prototype.na;lk.prototype.selectVideoTrack=function(im,jm){return this.b?this.b.selectVideoTrack(im,void 0==jm?true:jm):false;};lk.prototype.selectVideoTrack=lk.prototype.selectVideoTrack;lk.prototype.qa=function(im,jm,km){return this.b?ql(this.b,"audio",im,void 0==jm?true:jm,km):false;};lk.prototype.selectAudioTrack=lk.prototype.qa;lk.prototype.ra=function(im){return this.b?ql(this.b,"text",im,false):false;};lk.prototype.selectTextTrack=lk.prototype.ra;lk.prototype.ea=function(im){this.b&&ml(this.b,im);};lk.prototype.enableTextTrack=lk.prototype.ea;lk.prototype.U=function(im){pk(this);0<=im?this.a.playbackRate=im:this.a.paused||(this.a.playbackRate=0,this.A(this.a.currentTime,Date.now(),im));this.l=im;};lk.prototype.setPlaybackRate=lk.prototype.U;lk.prototype.M=function(){return this.l;};lk.prototype.getPlaybackRate=lk.prototype.M;lk.prototype.sa=function(im){this.C=im;};lk.prototype.setPlaybackStartTime=lk.prototype.sa;lk.prototype.I=function(){return this.b?this.b.kb():false;};lk.prototype.isLive=lk.prototype.I;lk.prototype.W=function(im){if(im){var jm=gc(im,"enableAdaptation");null!=jm&&(this.c.enableAdaptation=jm);jm=gc(im,"allowSkipUnloading");null!=jm&&(this.F=jm);jm=gc(im,"endBufferingOnPlaying");null!=jm&&(this.G=jm);jm=gc(im,"usePlaybackRateForBuffering");null!=jm&&(this.s=jm);jm=hc(im,"streamBufferSize",0);null!=jm&&(this.c.streamBufferSize=jm);jm=hc(im,"dynamicStreamBufferSize",0);null!=jm&&(this.c.dynamicStreamBufferSize=jm);jm=gc(im,"addCdnDebugQueryParameters");null!=jm&&(this.c.addCdnDebugQueryParameters=jm);jm=hc(im,"initialStreamBufferSize",0);null!=jm&&(this.c.initialStreamBufferSize=jm);jm=gc(im,"includeStreamBufferSizeInStartOffset");null!=jm&&(this.c.includeStreamBufferSizeInStartOffset=jm);jm=hc(im,"liveStreamEndTimeout",0);null!=jm&&(this.c.liveStreamEndTimeout=jm);jm=hc(im,"licenseRequestTimeout",0);null!=jm&&(this.c.licenseRequestTimeout=jm);jm=hc(im,"mpdRequestTimeout",0);null!=jm&&(this.c.mpdRequestTimeout=jm);jm=hc(im,"minMpdRefreshInterval",0);null!=jm&&(this.c.minMpdRefreshInterval=jm);jm=gc(im,"enableLiveInterruptionDetection");null!=jm&&(this.c.enableLiveInterruptionDetection=jm);jm=gc(im,"enableManifestDebug");null!=jm&&(this.c.enableManifestDebug=jm,jm||(tc.prototype.X=function(){}));jm=gc(im,"resolveVideoTimeUpdateOnFragmentedTimeRanges");null!=jm&&(this.c.resolveVideoTimeUpdateOnFragmentedTimeRanges=jm);jm=hc(im,"liveInterruptionConsecutiveUpdatesWithoutChange");null!=jm&&(this.c.liveInterruptionConsecutiveUpdatesWithoutChange=jm);jm=hc(im,"liveInterruptionConsecutiveUpdatesWithChange");null!=jm&&(this.c.liveInterruptionConsecutiveUpdatesWithChange=jm);jm=gc(im,"skipCallingSourceBufferAbort");null!=jm&&(this.c.skipCallingSourceBufferAbort=jm);jm=gc(im,"liveSendPushHeaders");null!=jm&&(this.c.liveSendPushHeaders=jm);jm=hc(im,"liveMaxManifestFetchesWithPush");null!=jm&&(this.c.liveMaxManifestFetchesWithPush=jm);jm=hc(im,"liveMaxSegmentsToPush");null!=jm&&(this.c.liveMaxSegmentsToPush=jm);jm=hc(im,"segmentRequestTimeout",0);null!=jm&&(this.c.segmentRequestTimeout=jm);jm=ic(im,"preferredLanguage");null!=jm&&(this.c.preferredLanguage=jm);jm=kc(im,"restrictions",w);null!=jm&&(this.c.restrictions=jm.clone());im=gc(im,"disableCacheBustingEvenThoughItMayAffectBandwidthEstimation");null!=im&&(eh=!im);this.b&&this.b.ib(this.c);}};lk.prototype.configure=lk.prototype.W;lk.prototype.ga=function(){return this.c;};lk.prototype.getConfiguration=lk.prototype.ga;function pk(im){im.i&&(j.clearTimeout(im.i),im.i=null);}function qk(im){rk(im);im.v=j.setTimeout(im.T.bind(im),100);}function rk(im){im.v&&(j.clearTimeout(im.v),im.v=null);}lk.prototype.A=function(im,jm,km){this.i=null;var lm=(Date.now()-jm)/1000*km;this.a.currentTime<this.B+(this.I()?1:.05)?this.a.pause():(lm=Math.max(this.B,im+lm),this.a.currentTime=lm,this.i=j.setTimeout(this.A.bind(this,im,jm,km),250));};function sk(im){r("buffering");var jm=im.g;jm.bufferingTime+=s("buffering")/1000;im.s&&(im.a.playbackRate=im.l);im.j=false;im.dispatchEvent(yb({type:"bufferingEnd"}));}lk.prototype.T=function(){qk(this);if(!this.a.ended&&!this.a.seeking){var im=this.a.buffered,jm=im.length?im.end(im.length-1):0,im=Math.max(jm-this.a.currentTime,0),km=this.a.currentTime,lm=this.a.duration,lm=isNaN(lm)?0:Math.max(lm-.05,0),jm=jm>=lm||km>=lm;if(this.j){if(jm=this.b,im>(jm.$a?Number(jm.g.streamBufferSize):Number(jm.g.initialStreamBufferSize))||bm(this.b))sk(this),this.H&&!this.s&&this.a.play();}else !this.a.paused&&!jm&&.5>im&&(this.j=true,this.s?this.a.playbackRate=0:this.a.pause(),this.g.bufferingHistory.push(fb()/1000),q("buffering"),this.dispatchEvent(yb({type:"bufferingStart"}))),bm(this.b)&&sk(this);}};var tk={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function uk(im){for(var jm=0;jm<im.length;++jm)for(var km=im[jm],lm=0;lm<km.a.length;++lm){for(var mm=km.a[lm],nm=mm,om=0;om<nm.o.length;++om)mk(si(nm.o[om]))||(nm.o.splice(om,1),--om);0==mm.o.length&&(km.a.splice(lm,1),--lm);}for(jm=0;jm<im.length;++jm)for(km=im[jm],lm=0;lm<km.a.length;++lm)km.a[lm].o.sort(vk);}function vk(im,jm){var km=im.bandwidth||Number.MAX_VALUE,lm=jm.bandwidth||Number.MAX_VALUE;return km<lm?-1:km>lm?1:0;}function wk(im){this.a=im;}wk.prototype.destroy=function(){this.a.destroy();this.a=null;};wk.prototype.update=function(im){var jm=xk(im),km=xk(this.a);return h.all([jm,km]).then(ed(this,function(lm){var mm=lm[0];lm=lm[1];uk(this.a.a);im.b&&!this.a.b&&(im.i=true);im.f=this.a.f;im.g=this.a.g?this.a.g.clone():null;im.c=this.a.c;var nm=[];yk(im,this.a,mm,lm,nm);uk(im.a);return h.resolve(nm);}));};function xk(im){function jm(lm,mm){return lm.concat(mm);}var km=im.a.map(function(lm){return lm.a;}).reduce(jm,[]).map(function(lm){return lm.o;}).reduce(jm,[]);im=km.map(function(lm){return lm.K.create();});return h.all(im).then(function(lm){for(var mm={},nm=0;nm<km.length;++nm)mm[km[nm].D]=lm[nm];return h.resolve(mm);});}function yk(im,jm,km,lm,mm){var nm=new lc();im.a.forEach(function(rm,sm){nm.push(rm.id||""+sm,rm);});var om=new lc();jm.a.forEach(function(rm,sm){om.push(rm.id||""+sm,rm);});im=oc(nm);for(jm=0;jm<im.length;++jm){var pm=im[jm],qm=nm.get(pm);1<qm.length||(pm=om.get(pm))&&0!=pm.length&&1==pm.length&&(zk(qm[0],pm[0],km,lm,mm),qm[0].b=pm[0].b);}}function zk(im,jm,km,lm,mm){var nm=new lc();im.a.forEach(function(rm,sm){nm.push(rm.id||""+sm,rm);});var om=new lc();jm.a.forEach(function(rm,sm){om.push(rm.id||""+sm,rm);});im=oc(nm);for(jm=0;jm<im.length;++jm){var pm=im[jm],qm=nm.get(pm);1<qm.length||(pm=om.get(pm))&&0!=pm.length&&1==pm.length&&al(qm[0],pm[0],km,lm,mm);}}function al(im,jm,km,lm,mm){var nm=new lc();im.o.forEach(function(tm,um){nm.push(tm.id||""+um,tm);});var om=new lc();jm.o.forEach(function(tm,um){om.push(tm.id||""+um,tm);});jm={};for(var pm=oc(nm),qm=0;qm<pm.length;++qm){var rm=pm[qm];jm[rm]=rm;var sm=nm.get(rm);1<sm.length||((rm=om.get(rm))&&0!=rm.length?1==rm.length&&(bl(sm[0],rm[0],km,lm),sm[0].L=rm[0].L,rm[0].L=null,sm[0].b=rm[0].b):(mm.push(sm[0]),im.o.splice(im.o.indexOf(sm[0]),1)));}pm=oc(om);for(qm=0;qm<pm.length;++qm)rm=pm[qm],jm[rm]||(jm[rm]=rm,rm=om.get(rm),im.o.push(rm[0]));}function bl(im,jm,km,lm){im=km[im.D];lm=lm[jm.D];jm=im.length();im.Ma(lm)&&(lm=im.length(),im.g.push(jm!==lm),50<im.g.length&&im.g.shift());}function cl(){this.a=this.b=null;this.f=new pc();this.c=Number.POSITIVE_INFINITY;this.i=true;this.g=false;}m("shaka.media.SimpleAbrManager",cl);cl.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null;};cl.prototype.initialize=function(im,jm){this.b||this.a||(this.b=im,this.a=jm);};cl.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4000,qc(this.f,this.b,"bandwidth",this.l.bind(this)),qc(this.f,this.a,"adaptation",this.j.bind(this)),qc(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=true);};cl.prototype.enable=function(im){this.i=im;};cl.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var im=dl(this);return im?im.id:null;};cl.prototype.getInitialSwitchReason=function(){return null;};cl.prototype.getInitialAudioTrackId=function(){return null;};cl.prototype.selectVideoTrack=function(im,jm,km){this.g&&this.a.selectVideoTrack(im.id,jm,km);};cl.prototype.l=function(){Date.now()<this.c||this.h();};cl.prototype.h=function(){if(this.i){var im=dl(this);if(im){if(im.active){this.c=Date.now()+3000;return;}this.selectVideoTrack(im,false);}this.c=Number.POSITIVE_INFINITY;}};cl.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+30000);};function dl(im){var jm=im.a.G();if(0==jm.length)return null;jm.sort(ga);var km;im:{km=im.a.W();for(var lm=0;lm<km.length;++lm)if(km[lm].active){km=km[lm];break im;}km=null;};km=km?km.bandwidth:0;im=im.b.getBandwidth();for(var lm=jm[0],mm=0;mm<jm.length;++mm){var nm=jm[mm],om=mm+1<jm.length?jm[mm+1]:{bandwidth:Number.POSITIVE_INFINITY};if(nm.bandwidth&&(om=(om.bandwidth+km)/.85,im>=(nm.bandwidth+km)/.95&&im<=om&&(lm=nm,lm.active)))break;}return lm;}function el(im,jm,km){tc.call(this,null);this.a=im;this.fa=jm;this.j=new pc();this.h=new MediaSource();this.f=null;this.Ea=0;this.Za=false;this.Da=0;this.Ca=3;this.sa=this.$a=false;this.qa=0;this.fb=1;this.ra=Infinity;this.Wa=false;this.b=new lc();this.l=km;this.l.initialize(jm,this);this.C=false;this.B="en";this.ga=false;this.H=null;this.v=new yc();this.mb=new yc();this.i=new w();this.A=null;this.gb=1;this.c={};this.U=new yc();this.pa=0;this.eb=15;this.s=null;this.Ta=this.bb=false;this.m={};this.O=this.M=this.I=null;this.g={};this.ea=false;this.lb=null;}n(el,tc);m("shaka.player.StreamVideoSource",el);el.prototype.ib=function(im){null!=im.streamBufferSize&&(this.g.streamBufferSize=im.streamBufferSize);null!=im.initialStreamBufferSize&&(this.g.initialStreamBufferSize=im.initialStreamBufferSize);null!=im.dynamicStreamBufferSize_&&(this.g.dynamicStreamBufferSize_=im.dynamicStreamBufferSize_);null!=im.addCdnDebugQueryParameters&&(this.g.addCdnDebugQueryParameters=im.addCdnDebugQueryParameters);null!=im.segmentRequestTimeout&&(this.g.segmentRequestTimeout=im.segmentRequestTimeout);null!=im.resolveVideoTimeUpdateOnFragmentedTimeRanges&&(this.g.resolveVideoTimeUpdateOnFragmentedTimeRanges=im.resolveVideoTimeUpdateOnFragmentedTimeRanges);null!=im.skipCallingSourceBufferAbort&&(this.g.skipCallingSourceBufferAbort=im.skipCallingSourceBufferAbort);gm(this);null!=im.includeStreamBufferSizeInStartOffset&&(this.Za=Boolean(im.includeStreamBufferSizeInStartOffset));null!=im.enableAdaptation&&this.l.enable(Boolean(im.enableAdaptation));null!=im.mpdRequestTimeout&&(this.Da=Number(im.mpdRequestTimeout));null!=im.minMpdRefreshInterval&&(this.Ca=Number(im.minMpdRefreshInterval)/1000);null!=im.enableManifestDebug&&(this.Wa=!!im.enableManifestDebug);null!=im.liveStreamEndTimeout&&(this.eb=Number(im.liveStreamEndTimeout));null!=im.preferredLanguage&&(this.B=dc(String(im.preferredLanguage)));null!=im.liveSendPushHeaders&&(this.sa=Boolean(im.liveSendPushHeaders));null!=im.liveMaxManifestFetchesWithPush&&(this.qa=Number(im.liveMaxManifestFetchesWithPush));null!=im.liveMaxSegmentsToPush&&(this.ra=Number(im.liveMaxSegmentsToPush));null!=im.restrictions&&(this.i=im.restrictions,this.C&&nl(this));};el.prototype.destroy=function(){this.v.destroy();this.U.destroy();this.U=this.v=null;this.M&&(j.clearTimeout(this.M),this.M=null);this.I&&(j.clearTimeout(this.I),this.I=null);this.m=null;this.j.destroy();this.j=null;fc(this.c).forEach(function(im){im.destroy();});this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);this.l.destroy();this.S=this.i=this.H=this.f=this.h=this.fa=this.l=null;};function fl(im,jm){qc(im.j,im.h,"sourceopen",im.Bb.bind(im));jm.src=j.URL.createObjectURL(im.h);}k=el.prototype;k.cb=function(){};function gl(im,jm,km){if(!im.C)return im=Error("Cannot call attach() right now."),im.type="app",h.reject(im);im.S=jm;im.f=km;im.H=jm.ub();qc(im.j,im.fa,"bandwidth",im.Yb.bind(im));im.a.b&&(qc(im.j,jm,"bufferingStart",im.zb.bind(im)),qc(im.j,jm,"bufferingEnd",im.yb.bind(im)));jm=im.f.setMediaKeys(im.f.mediaKeys);im.mb.then(ed(im,function(){sl(this).then(ed(this,function(){this.v&&this.v.resolve();this.cb();})).catch(ed(this,function(lm){this.v&&this.v.reject(lm);}));}));return h.all([im.v,jm]);}k.ya=function(){if(this.C){var im=Error("Cannot call load() right now.");im.type="app";return h.reject(im);}if(!this.a||0==this.a.a.length)return im=Error("The manifest does not specify any content."),im.type="stream",h.reject(im);uk(this.a.a);if(0==this.a.a.length||0==this.a.a[0].a.length||!this.a.a[0].a.some(function(jm){return "video"===jm.contentType;}))return im=Error("The manifest specifies content that cannot be displayed on this browser/platform."),im.type="stream",h.reject(im);this.C=true;this.g.initialStreamBufferSize=Math.max(this.g.initialStreamBufferSize||0,this.a.c);gm(this);nl(this);return h.resolve();};function hl(im){var jm=yb({type:"manifestwrapped",bubbles:true});im.dispatchEvent(jm);}k.pb=function(im){var jm=Date.now(),km=this.I=null,lm,mm;if(this.sa&&(!this.qa||this.qa>this.fb)){lm=Math.floor(dm(this))+1;lm=Math.min(lm,this.ra);var nm=this.c.video;if(nm=nm?nm.Ja():null)nm=nm.w(),null!=nm.a&&(mm=nm.a);if(this.f.paused||this.ea)lm=0;}lm&&this.fb++;nm=this.a.g;(im?this.nb():this.ob(nm,lm,mm)).then(ed(this,function(om){km=new wk(om);return km.update(this.a);})).then(ed(this,function(om){km.destroy();km=null;var pm=cm(this);this.X("SegmentIndexesUpdated",pm);pm.some(function(qm){return qm.Sa;})&&hl(this);(pm=em(this,pm))&&this.f.paused&&pm.end>this.f.currentTime+10&&(this.f.currentTime=pm.end);if(bm(this))return this.wa();for(pm=0;pm<om.length;++pm)jl(this,om[pm]);this.g.initialStreamBufferSize=Math.max(this.g.initialStreamBufferSize||0,this.a.c);this.g.useInitialBufferSizeWhenPaused=this.a.b;gm(this);nl(this);0==Object.keys(this.c).length?sl(this):il(this,(Date.now()-jm)/1000);})).catch(ed(this,function(om){km&&(km.destroy(),km=null);if("delay"==om.type)return il(this,0);"aborted"!=om.type&&(om=zb(om),this.dispatchEvent(om),this.a&&il(this,0));}));};k.ob=function(){return h.reject("Cannot update manifest with this VideoSource implementation.");};k.nb=function(){return h.reject("Cannot update manifest with this VideoSource implementation.");};function il(im,jm){if(null!=im.a.f){var km=Math.max(im.a.f,im.Ca),km=Math.max(km-jm,0);im.I=j.setTimeout(im.pb.bind(im,false),1000*km);}}function jl(im,jm){var km=jm.a.split("/")[0],lm=im.c[km];if(lm&&lm.ta()==jm){var mm=im.b.get(jm.a.split("/")[0]).map(function(nm){return nm.o;}).reduce(function(nm,om){return nm.concat(om);},[]).filter(function(nm){return nm.P&&nm.J;});if(0==mm.length){km=Error("All usable streams have been removed from the manifest.");km.type="app";km=zb(km);im.dispatchEvent(km);return;}im.m[km].Qa==jm&&delete im.m[km];lm.ua(mm[0],true);jm.destroy();}jm.destroy();}k.Wb=function(im){this.lb=im;};el.prototype.setTaggedTimeRangesEntryAdder=el.prototype.Wb;el.prototype.G=function(){if(!this.b||!this.b.a.hasOwnProperty("video"))return [];for(var im=this.c.video,im=(im=im?im.ta():null)?im.D:0,jm=[],km=this.b.get("video"),lm=0;lm<km.length;++lm)for(var mm=km[lm],nm=0;nm<mm.o.length;++nm){var om=mm.o[nm];if(om.P&&om.J){var pm=om.D,om=new fa(pm,om.bandwidth,om.width,om.height,om.id,om.fbQualityLabel,om.fbQualityClass);pm==im&&(om.active=true);jm.push(om);}}return jm;};el.prototype.getVideoTracks=el.prototype.G;function kl(im){im=im.G();for(var jm=0;jm<im.length;jm++)if(im[jm].active)return im[jm];}el.prototype.W=function(){if(!this.b||!this.b.a.hasOwnProperty("audio"))return [];for(var im=this.c.audio,im=(im=im?im.ta():null)?im.D:0,jm=[],km=this.b.get("audio"),lm=0;lm<km.length;++lm)for(var mm=km[lm],nm=mm.lang,om=0;om<mm.o.length;++om){var pm=mm.o[om];if(pm.P&&pm.J){var qm=pm.D,pm=new v(qm,pm.bandwidth,nm,pm.id);qm==im&&(pm.active=true);jm.push(pm);}}return jm;};el.prototype.getAudioTracks=el.prototype.W;el.prototype.jb=function(){if(!this.b||!this.b.a.hasOwnProperty("text"))return [];for(var im=this.c.text,jm=im?im.ta():null,jm=jm?jm.D:0,km=[],lm=this.b.get("text"),mm=0;mm<lm.length;++mm)for(var nm=lm[mm],om=nm.lang,pm=0;pm<nm.o.length;++pm){var qm=nm.o[pm].D,rm=new ea(qm,om);qm==jm&&(rm.active=true,rm.enabled=im.Ga());km.push(rm);}return km;};el.prototype.getTextTracks=el.prototype.jb;function ll(im,jm){if(im.C){for(var km={},lm=im.a.a[0],mm=0;mm<lm.a.length;++mm){var nm=lm.a[mm];km[nm.D]=nm;}im.b.a={};lm=oc(jm);for(mm=0;mm<lm.length;++mm){var nm=lm[mm],om=jm.get(nm);if("video"==nm){var pm=om[0].id;im.b.push(nm,km[pm]);}else if("audio"==nm){for(var pm=om[0].b.split(";")[0],qm=0;qm<om.length;++qm){var rm=om[qm];rm.b.split(";")[0]==pm&&im.b.push(nm,km[rm.id]);}}else for(qm=0;qm<om.length;++qm)pm=om[qm].id,im.b.push(nm,km[pm]);}im.ga=true;if(km=im.b.get("audio"))rl(im,km),im.b.set("audio",km),km=km[0].lang||im.B,ac(2,im.B,km)&&(im.ga=false);if(km=im.b.get("text"))rl(im,km),im.b.set("text",km),km=km[0].lang||im.B,ac(2,im.B,km)||(im.ga=false);}}el.prototype.selectVideoTrack=function(im,jm,km,lm){return ql(this,"video",im,jm,km,lm);};function ml(im,jm){var km=im.c.text;km&&km.xa(jm);}function nl(im){if(im.i){for(var jm=false,km=0;km<im.a.a.length;++km)for(var lm=im.a.a[km],mm=0;mm<lm.a.length;++mm){var nm=lm.a[mm];if("video"==nm.contentType)for(var om=0;om<nm.o.length;++om){var pm=nm.o[om],qm=pm.J;pm.J=true;im.i.maxWidth&&pm.width>im.i.maxWidth&&(pm.J=false);im.i.maxHeight&&pm.height>im.i.maxHeight&&(pm.J=false);im.i.minHeight&&pm.height<im.i.minHeight&&(pm.J=false);im.i.maxBandwidth&&pm.bandwidth>im.i.maxBandwidth&&(pm.J=false);im.i.minBandwidth&&pm.bandwidth<im.i.minBandwidth&&(pm.J=false);qm!=pm.J&&(jm=true);}}0!=mc(im.b).length&&jm&&(pl(im),0<im.G().length||(jm=Error("The application has restricted all video tracks!"),jm.type="app",jm=zb(jm),im.dispatchEvent(jm)));}}el.prototype.kb=function(){return this.a?this.a.b:false;};el.prototype.isLive=el.prototype.kb;el.prototype.Rb=function(im){this.$a=im;};el.prototype.setIsLiveInterrupted=el.prototype.Rb;el.prototype.Zb=function(){for(var im in this.c)this.c[im].sb();};el.prototype.forceResyncVideoBuffer=el.prototype.Zb;function ol(im,jm){for(var km,lm=false,mm=new lc(),nm=mc(im.b),om=0;om<nm.length;++om)for(var pm=nm[om],qm=0;qm<pm.o.length;++qm){var rm=pm.o[qm];rm.f.forEach(function(sm){mm.push(sm,rm);});}for(km in jm)if(nm=vb[jm[km]]||null,pm=mm.get(km)){for(om=0;om<pm.length;++om)rm=pm[om],qm=rm.P,rm.P=!nm,qm!=rm.P&&(lm=true);}else zc(km);lm&&(pl(im),lm=im.W(),km=im.G(),lm=im.b.a.hasOwnProperty("audio")&&0==lm.length,km=im.b.a.hasOwnProperty("video")&&0==km.length,lm||km)&&(km=Error("The key system has restricted all "+(lm&&km?"audio and video tracks.":lm?"audio tracks.":"video tracks.")),km.type="drm",km=zb(km),im.dispatchEvent(km));}function pl(im){var jm=yb({type:"trackschanged",bubbles:true});im.dispatchEvent(jm);}function ql(im,jm,km,lm,mm,nm){if(!im.b.a.hasOwnProperty(jm)||!im.c[jm])return false;for(var om=im.b.get(jm),pm=0;pm<om.length;++pm)for(var qm=om[pm],rm=0;rm<qm.o.length;++rm){var sm=qm.o[rm];if(sm.D==km){if(!sm.P||!sm.J)return false;if("text"!=jm&&!im.Ta)return km=im.m[jm],im.m[jm]={Qa:sm,Xa:null!=km&&km.Xa||lm,Ya:null!=km&&km.Ya||mm,switchReason:nm},true;zj(im.H,sm);im.c[jm].ua(sm,lm,mm,nm);return true;}}return false;}function rl(im,jm){for(var km=0;2>=km;++km)for(var lm=0;lm<jm.length;++lm){var mm=jm[lm];if(ac(km,im.B,mm.lang)){jm.splice(lm,1);jm.splice(0,0,mm);return;}}for(lm=0;lm<jm.length;++lm)if(mm=jm[lm],mm.b){jm.splice(lm,1);jm.splice(0,0,mm);break;}}k=el.prototype;k.Bb=function(){this.j.va(this.h,"sourceopen");this.mb.resolve();};function sl(im){for(var jm=[],km=["audio","video","text"],lm=0;lm<km.length;++lm){var mm=km[lm];im.b.a.hasOwnProperty(mm)&&jm.push(im.b.get(mm)[0]);}for(var nm=tl(im,jm),lm=0;lm<km.length;++lm)if(mm=km[lm],im.b.a.hasOwnProperty(mm)&&!nm[mm])return im=Error("Unable to select an initial "+mm+" stream: all "+mm+" streams have been restricted (by the application or by the key system)."),im.type="stream",h.reject(im);jm=fc(nm).map(function(om){return om.K.create();});return h.all(jm).then(ed(im,function(om){if(!om.every(function(pm){return pm.length();}))return om=Error("Some streams are not available."),om.type="stream",h.reject(om);om=em(this,om);if(!om)return om=Error("Some streams are not available."),om.type="stream",h.reject(om);if(!ul(this,nm))return om=Error("Failed to create Stream objects."),om.type="stream",h.reject(om);this.l.start();wl(this,nm,om);return h.resolve();})).catch(ed(im,function(om){if("aborted"!=om.type)return Object.keys(this.c),this.a.b?(fb()<this.a.h?(om=Math.max(this.a.h-Date.now()/1000,this.Ca),this.I=j.setTimeout(this.pb.bind(this,true),1000*om)):il(this,0),h.resolve()):h.reject(om);}));}function tl(im,jm){for(var km={},lm=0;lm<jm.length;++lm){var mm=jm[lm],nm=null;if("video"==mm.contentType){var om=im.l.getInitialVideoTrackId();if(null==om)continue;nm=mm.o.filter(function(pm){return pm.D==om;});if(0==nm.length)continue;nm=nm[0];}else if("audio"==mm.contentType){if(om=im.l.getInitialAudioTrackId(),nm=mm.o.filter(function(pm){return pm.D==om;}),0==nm.length){nm=mm.o.filter(function(pm){return pm.P&&pm.J;});if(0==nm.length)continue;nm=mm.o[Math.floor(nm.length/2)];}else nm=nm[0];}else 0<mm.o.length&&(nm=mm.o[0]);km[mm.contentType]=nm;}return km;}function ul(im,jm){var km={},lm;for(lm in jm){var mm=jm[lm],mm="text"==lm?new jj(im,im.f):vl(im,mm);if(!mm)return fc(km).forEach(function(nm){nm.destroy();}),false;km[lm]=mm;}im.c=km;return true;}function vl(im,jm){var km=new zi(im,im.f,im.h,si(jm),im.fa,im.lb);km.I(im.g);return km;}function wl(im,jm,km){im.gb=im.f.playbackRate;im.f.playbackRate=0;yl(im,km);var lm;im.O&&im.O<=km.end&&im.O>=km.start?lm=im.O:im.a.b?(lm=km.end,im.bb=true):lm=km.start;qc(im.j,im.f,"seeking",im.Ib.bind(im));im.f.currentTime!=lm&&(im.f.currentTime=lm,im.A=lm);zl(im,km.start,km.end);var mm=[],nm;for(nm in im.c){km=im.c[nm];ed(im,function(pm){mm.push(pm.vb(this.U).then(ed(this,function(qm){var rm=pm.Ha();rm>this.Ea&&(this.Ea=rm);return qm;})));})(km);qc(im.j,km,"ended",im.Jb.bind(im));lm=jm[nm];zj(im.H,lm);var om=im.l.getInitialSwitchReason()||void 0;km.ua(lm,false,void 0,om);}h.all(mm).then(im.xb.bind(im)).catch(ed(im,function(pm){"destroy"!=pm.type&&(pm=zb(pm),this.dispatchEvent(pm));}));ml(im,im.ga);}k.xb=function(im){o(im&&im.length==Object.keys(this.c).length);for(var jm=Number.POSITIVE_INFINITY,km=Number.NEGATIVE_INFINITY,lm=0;lm<im.length;++lm)var mm=im[lm],jm=Math.min(jm,mm),km=Math.max(km,mm);im=cm(this);for(lm=0;lm<im.length;++lm)im[lm].la(km);xl(this,im,km);lm=mc(this.b).map(function(nm){return nm.o;}).reduce(function(nm,om){return nm.concat(om);},[]).map(function(nm){var om=[nm.K.create()];nm.L&&om.push(nm.L.create());return h.all(om);});h.all(lm).then(ed(this,function(nm){for(var om=0;om<nm.length;++om)nm[om][0].la(km);this.Ta=true;for(var pm in this.m)nm=this.m[pm],om=this.c[pm],zj(this.H,nm.Qa),om.ua(nm.Qa,nm.Xa,nm.Ya,nm.switchReason);this.m={};})).catch(ed(this,function(nm){"aborted"!=nm.type&&(nm=zb(nm),this.dispatchEvent(nm));}));};function xl(im,jm,km){if(jm=em(im,jm))yl(im,jm),zl(im,jm.start,jm.end);0!=km?(km=im.f.currentTime+km,im.f.currentTime=km,im.A=km):im.bb&&jm&&(im.f.currentTime=jm.end);im.f.playbackRate=im.gb;im.a.b&&null!=im.a.f&&il(im,0);fm(im);im.U.resolve();}function yl(im,jm){if(im.a.b){isNaN(im.h.duration)&&(im.h.duration=jm.end+2592000);}else if(isNaN(im.h.duration)||jm.end>im.h.duration){im.h.duration=jm.end;for(var km=0;km<im.h.sourceBuffers.length;++km)im.h.sourceBuffers[km].appendWindowEnd=jm.end;}}k.Kb=function(){this.M=null;fm(this);var im=em(this,cm(this));im&&(this.a.b&&this.pa!=im.w&&(this.pa=im.w,null!=this.s&&(j.clearTimeout(this.s),this.s=null)),zl(this,im.start,im.end),this.f.paused||am(this,this.f.currentTime,im.start,im.end));};function zl(im,jm,km){jm=yb({type:"seekrangechanged",bubbles:true,start:jm,end:km});im.dispatchEvent(jm);}k.Ib=function(){var im=this.f.currentTime;if(null!=this.A){if(im>=this.A-.01&&im<=this.A+.01){this.A=null;return;}this.A=null;}var jm=em(this,cm(this));if(jm){var km=jm.end;(jm=am(this,im,jm.start,km))||(im<=km+.01?jm=false:(this.f.currentTime=km,jm=true));if(!jm)for(var lm in this.c)this.c[lm].rb();}};function am(im,jm,km,lm){if(jm>=km-.01)return false;jm=0;if(im.a.b){jm=.5;for(var mm in im.c)if(!im.c[mm].tb(km+jm)){jm=im.a.c;break;}}im.f.currentTime=Math.min(km+jm,lm);return true;}k.Jb=function(){if(!this.a.b){for(var im in this.c)if(!this.c[im].La())return;this.wa();}};function bm(im){return im.a.i&&im.f.currentTime+.5>im.pa?true:false;}k.zb=function(){this.ea=true;if(bm(this))return this.wa();fc(this.c).every(function(im){return im.La();})&&(this.s=j.setTimeout(this.wa.bind(this),1000*this.eb));};k.yb=function(){this.ea=false;null!=this.s&&(j.clearTimeout(this.s),this.s=null);};k.Yb=function(){var im=this.H,jm=this.fa.getBandwidth();im.estimatedBandwidth=jm;im.bandwidthHistory.push(new bk(jm));};k.wa=function(){this.ea=false;this.s=null;this.h.endOfStream();};function cm(im){return fc(im.c).map(function(jm){return jm.Ja();}).filter(function(jm){return null!=jm;});}function dm(im){return Math.max(im.a?im.a.c:1,im.Za?im.g.streamBufferSize||0:0);}function em(im,jm){for(var km=0,lm=Number.POSITIVE_INFINITY,mm=Number.POSITIVE_INFINITY,nm=0;nm<jm.length;++nm){var om=jm[nm].Ia(),km=Math.max(km,om.start);null!=om.end&&(lm=Math.min(lm,om.end));jm[nm].length()&&(mm=Math.min(mm,jm[nm].w().endTime));}if(lm==Number.POSITIVE_INFINITY)if(lm=im.a.a[0],lm.b){lm=(lm.start||0)+lm.b;}else return null;im.a.b&&(nm=dm(im),lm=Math.max(lm-nm,km));if(km>lm)return null;lm=Math.floor(100000*lm)/100000;return {start:km,end:lm,w:mm};}function fm(im){im.a.b&&(im.M=j.setTimeout(im.Kb.bind(im),1000));}function gm(im){for(var jm in im.c)im.c[jm].I(im.g);}k.Ha=function(){return this.Ea;};el.prototype.getLongestInitResponseTime=el.prototype.Ha;function hm(im,jm,km,lm){km||(km=new vc());lm||(lm=new cl());el.call(this,null,km,lm);"string"===typeof im?this.Qb=im:this.hb=im;this.T=null;this.V=jm;this.na=[];this.Ua=[];this.Va=[];this.oa=0;this.F=null;}n(hm,el);m("shaka.player.DashVideoSource",hm);hm.prototype.Sb=function(im,jm,km){this.na.push(im);this.Ua.push(jm||"");this.Va.push(km||"");};hm.prototype.addExternalCaptions=hm.prototype.Sb;hm.prototype.Ub=function(im){this.F=im;};hm.prototype.setNetworkCallback=hm.prototype.Ub;hm.prototype.destroy=function(){this.T=this.F=this.V=null;el.prototype.destroy.call(this);};hm.prototype.ya=function(){var im,jm=ed(this,function(nm){this.X("MPDFetchDuration",(Date.now()-im)/1000);this.T=nm;for(var om=0;om<this.na.length;om++){var pm=nm,qm=this.na[om],rm=this.Ua[om],sm=this.Va[om];if(0!==pm.a.length){var tm=new tf();tm.contentType="text";tm.lang=rm||"en";tm.c=true;rm=new wf();rm.bandwidth=0;rm.f=sm||"text/vtt";rm.u=[new bf(qm)];tm.a.push(rm);pm.a[0].b.push(tm);kg(pm.a[0]);}}this.a=nj(new mj(this.V),nm,this.F);return el.prototype.ya.call(this);});if(this.hb)return im=Date.now(),jm(this.hb);var km=[new bf(this.Qb)],lm;if(this.sa){lm=Math.floor(dm(this))+1;var mm=kl(this);lm=Math.min(lm,this.ra);lm=new sh(lm);lm.b=Math.floor(dm(this)+1);null!=mm&&(lm.a=mm.streamInfoID);}km=new lh(this.F,km);km=new qh(km,this.Da,lm);im=Date.now();return rh(km).then(jm);};hm.prototype.cb=function(){if(this.Wa){var im=this.a;if(im=(im=im&&im.a)&&im[0])im=im.a.reduce(function(jm,km){return jm.concat(km.o);},[]),h.all(im.map(function(jm){return jm.K.ka;})).then(function(jm){jm=jm.filter(function(km){return null!=km;});this.X("InitialSegmentIndexes",jm);}.bind(this));}};hm.prototype.ob=function(im,jm,km){if(this.f.paused&&this.oa+10000>Date.now()&&this.a)return h.reject({type:"delay"});var lm;jm&&void 0!=km&&(lm=new sh(jm),lm.c=km,jm=kl(this),null!=jm&&(lm.a=jm.streamInfoID));im=new qh(im,this.Da,lm);var mm=Date.now();return rh(im).then(ed(this,function(nm){this.oa=Date.now();this.X("MPDFetchDuration",(this.oa-mm)/1000);this.T=nm;nm=nj(new mj(this.V),nm,this.F);return h.resolve(nm);}));};hm.prototype.nb=function(){var im=nj(new mj(this.V),this.T,this.F);return h.resolve(im);};}.bind(i,b))();f.exports=i.shaka;}),null);